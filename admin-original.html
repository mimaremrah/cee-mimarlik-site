<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CEE | Yönetim Paneli</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2d3748;
            --gold: #c5a059;
            --dark: #1a1a1a;
            --light: #f8f9fa;
            --border: #e2e8f0;
            --success: #10b981;
            --danger: #ef4444;
            --info: #3b82f6;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            transition: all 0.3s ease;
        }

        /* DARK MODE */
        body.dark-mode {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
        }

        body.dark-mode .admin-container,
        body.dark-mode .preview-panel,
        body.dark-mode .login-screen {
            background: #1e293b;
            color: #e2e8f0;
        }

        body.dark-mode .admin-header {
            border-bottom-color: #334155;
        }

        body.dark-mode h1, body.dark-mode h2, body.dark-mode h3, body.dark-mode h4 {
            color: #e2e8f0;
        }

        body.dark-mode .upload-section,
        body.dark-mode .zone-content {
            background: #0f172a;
        }

        body.dark-mode .zone-container {
            border-color: #334155;
        }

        body.dark-mode .empty-message {
            color: #64748b;
        }

        body.dark-mode input {
            background: #0f172a;
            color: #e2e8f0;
            border-color: #334155;
        }

        body.dark-mode .stat-card {
            background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
        }

        body.dark-mode .mobile-screen {
            background: #0f172a;
        }

        /* CONTEXT MENU (SAĞ TIK) */
        .context-menu {
            position: fixed;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            padding: 8px 0;
            z-index: 9999;
            min-width: 180px;
            max-height: 400px;
            overflow-y: auto;
            display: none;
        }

        .context-menu.show {
            display: block;
        }

        .context-menu-item {
            padding: 10px 16px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .context-menu-item:hover {
            background: #f3f4f6;
        }

        .context-menu-divider {
            height: 1px;
            background: #e5e7eb;
            margin: 4px 0;
        }

        body.dark-mode .context-menu {
            background: #1e293b;
            color: #e2e8f0;
        }

        body.dark-mode .context-menu-item:hover {
            background: #334155;
        }

        /* ETİKETLER */
        .project-tags {
            position: absolute;
            bottom: 40px;
            left: 5px;
            display: flex;
            gap: 4px;
            flex-wrap: wrap;
            max-width: calc(100% - 10px);
        }

        .tag {
            background: rgba(59, 130, 246, 0.9);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 9px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .tag.villa { background: rgba(139, 92, 246, 0.9); }
        .tag.apartman { background: rgba(59, 130, 246, 0.9); }
        .tag.ofis { background: rgba(16, 185, 129, 0.9); }
        .tag.ticari { background: rgba(245, 158, 11, 0.9); }
        .tag.konut { background: rgba(239, 68, 68, 0.9); }
        .tag.diger { background: rgba(107, 114, 128, 0.9); }

        /* CLICK COUNTER */
        .click-counter {
            position: absolute;
            bottom: 5px;
            right: 5px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 3px;
            backdrop-filter: blur(4px);
        }

        .click-counter .icon {
            font-size: 12px;
        }

        /* LOGIN */
        .login-screen {
            max-width: 400px;
            margin: 100px auto;
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .login-screen h1 {
            text-align: center;
            margin-bottom: 30px;
            color: var(--dark);
        }

        .login-screen input {
            width: 100%;
            padding: 12px;
            margin-bottom: 15px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 14px;
        }

        .login-screen button {
            width: 100%;
            padding: 12px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
        }

        .login-screen button:hover {
            background: #1a202c;
        }

        .login-error {
            color: var(--danger);
            text-align: center;
            margin-bottom: 10px;
            display: none;
        }

        /* MAIN */
        .admin-wrapper {
            max-width: 1600px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 500px;
            gap: 20px;
        }

        .admin-container {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .admin-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding-bottom: 30px;
            border-bottom: 2px solid var(--border);
            margin-bottom: 40px;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .logo-preview {
            width: 80px;
            height: 80px;
            object-fit: contain;
            background: var(--light);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 10px;
        }

        .logo-info h2 {
            font-size: 24px;
            color: var(--dark);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-warning {
            background: #f59e0b;
            color: white;
        }

        .btn-warning:hover {
            background: #d97706;
        }

        .btn-info {
            background: #3b82f6;
            color: white;
        }

        .btn-info:hover {
            background: #2563eb;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 15px;
            margin-bottom: 40px;
        }

        @media (min-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (min-width: 1200px) {
            .stats-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        @media (min-width: 1600px) {
            .stats-grid {
                grid-template-columns: repeat(8, 1fr);
            }
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 25px;
            border-radius: 12px;
            color: white;
        }

        .stat-number {
            font-size: 36px;
            font-weight: 700;
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.9;
        }

        .upload-section {
            background: var(--light);
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
        }

        .upload-section h3 {
            font-size: 18px;
            margin-bottom: 20px;
        }

        .upload-box {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .upload-box input {
            flex: 1;
            padding: 12px;
            border: 2px dashed var(--border);
            border-radius: 8px;
        }

        /* HIZLI İŞLEMLER PANELİ */
        .quick-actions-panel {
            background: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
        }

        body.dark-mode .quick-actions-panel {
            background: #1e293b;
        }

        body.dark-mode .quick-actions-panel h3 {
            color: #e5e7eb;
        }

        .quick-actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .quick-action-card {
            background: linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%);
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s;
        }

        .quick-action-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            border-color: #667eea;
        }

        .quick-action-card-wide {
            grid-column: span 2;
        }

        body.dark-mode .quick-action-card {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            border-color: #334155;
        }

        body.dark-mode .quick-action-card:hover {
            border-color: #667eea;
        }

        .quick-action-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
            padding-bottom: 12px;
            border-bottom: 2px solid #e5e7eb;
        }

        body.dark-mode .quick-action-header {
            border-bottom-color: #334155;
        }

        .quick-action-icon {
            font-size: 28px;
            flex-shrink: 0;
        }

        .quick-action-header h4 {
            margin: 0;
            font-size: 16px;
            font-weight: 600;
            color: #1f2937;
        }

        body.dark-mode .quick-action-header h4 {
            color: #e5e7eb;
        }

        .quick-action-body {
            display: flex;
            flex-direction: column;
        }

        .btn-sm {
            padding: 10px 16px;
            font-size: 14px;
            border-radius: 8px;
            font-weight: 500;
        }

        .mini-select {
            padding: 10px 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 14px;
            background: white;
            cursor: pointer;
            transition: all 0.2s;
        }

        .mini-select:hover {
            border-color: #667eea;
        }

        body.dark-mode .mini-select {
            background: #1e293b;
            border-color: #334155;
            color: #e5e7eb;
        }

        @media (max-width: 968px) {
            .quick-actions-grid {
                grid-template-columns: 1fr;
            }

            .quick-action-card-wide {
                grid-column: span 1;
            }
        }

        .zone-container {
            background: white;
            border: 2px solid var(--border);
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 30px;
        }

        .zone-header {
            background: var(--primary);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
        }

        .zone-content {
            padding: 20px;
            min-height: 200px;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }

        .zone-content.drag-over {
            background: #f0f9ff;
        }

        .project-card {
            position: relative;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            cursor: move;
            aspect-ratio: 16/10;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .project-card:active {
            transform: scale(0.98);
            box-shadow: 0 1px 4px rgba(0,0,0,0.2);
        }

        .project-card img[alt="Project"] {
            transition: opacity 0.2s;
        }

        .project-card:active img[alt="Project"] {
            opacity: 0.9;
        }

        /* Tıklama animasyonu */
        @keyframes click-pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(102, 126, 234, 0.7);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(102, 126, 234, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(102, 126, 234, 0);
            }
        }

        .project-card.clicked {
            animation: click-pulse 0.4s;
        }

        .project-card.favorite {
            box-shadow: 0 0 0 3px #f59e0b;
        }

        .project-title {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
            color: white;
            padding: 20px 10px 10px 10px;
            font-size: 11px;
            font-weight: 500;
            max-height: 35px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .favorite-btn {
            position: absolute;
            top: 10px;
            right: 50px;
            background: rgba(255,255,255,0.9);
            border: none;
            padding: 6px 10px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            opacity: 0;
            transition: all 0.3s;
            z-index: 10;
        }

        .project-card:hover .favorite-btn {
            opacity: 1;
        }

        .project-card.favorite .favorite-btn {
            opacity: 1;
            background: #f59e0b;
        }

        .edit-title-btn {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(255,255,255,0.9);
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 10px;
            opacity: 0;
            transition: all 0.3s;
            z-index: 10;
        }

        .project-card:hover .edit-title-btn {
            opacity: 1;
        }

        .project-card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .project-logo {
            position: absolute;
            top: 8px;
            left: 8px;
            width: 18px !important;
            height: 18px !important;
            max-width: 18px !important;
            max-height: 18px !important;
            object-fit: contain;
            background: rgba(255,255,255,0.9);
            border-radius: 3px;
            padding: 2px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }

        .delete-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--danger);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            opacity: 0;
            transition: all 0.3s;
        }

        .project-card:hover .delete-btn {
            opacity: 1;
        }

        .empty-message {
            text-align: center;
            color: #adb5bd;
            grid-column: 1/-1;
            padding: 40px;
        }

        /* PREVIEW */
        .preview-panel {
            position: sticky;
            top: 20px;
            height: fit-content;
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .preview-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .preview-tabs {
            display: flex;
            gap: 5px;
        }

        .preview-tab {
            padding: 8px 16px;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
        }

        .preview-tab.active {
            background: white;
            color: var(--primary);
        }

        .preview-content {
            padding: 20px;
        }

        .preview-mode {
            display: none;
        }

        .preview-mode.active {
            display: block;
        }

        .mobile-frame {
            background: #1a1a1a;
            border-radius: 30px;
            padding: 15px;
            margin: 0 auto;
            max-width: 320px;
        }

        .mobile-screen {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            padding: 15px;
            min-height: 500px;
        }

        .preview-project-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }

        .desktop-preview .preview-project-grid {
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        .preview-project-card {
            position: relative;
            border-radius: 12px;
            overflow: hidden;
            aspect-ratio: 16/10;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .preview-project-card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .preview-logo {
            position: absolute;
            top: 5px;
            left: 5px;
            width: 12px !important;
            height: 12px !important;
            max-width: 12px !important;
            max-height: 12px !important;
            object-fit: contain;
            background: rgba(255,255,255,0.9);
            border-radius: 2px;
            padding: 1px;
        }

        .preview-section-title {
            font-size: 14px;
            font-weight: 600;
            margin: 20px 0 10px 0;
            text-transform: uppercase;
        }

        .hidden {
            display: none !important;
        }

        /* FULLSCREEN MODAL */
        .fullscreen-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.95);
            z-index: 10000;
            align-items: center;
            justify-content: center;
        }

        .fullscreen-modal.show {
            display: flex;
        }

        .fullscreen-content {
            position: relative;
            max-width: 90%;
            max-height: 90%;
        }

        .fullscreen-modal img.main-img {
            max-width: 100%;
            max-height: 90vh;
            object-fit: contain;
        }

        .fullscreen-logo {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 80px;
            height: 80px;
            object-fit: contain;
            background: rgba(255,255,255,0.15);
            border-radius: 8px;
            padding: 10px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.2);
            opacity: 0.7;
            transition: opacity 0.3s;
        }

        .fullscreen-logo:hover {
            opacity: 1;
        }

        .fullscreen-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
        }

        .fullscreen-close:hover {
            background: #ef4444;
            color: white;
        }

        /* FILE CONVERTER */
        .converter-section {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-top: 30px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
        }

        body.dark-mode .converter-section {
            background: #1e293b;
        }

        .converter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .converter-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            padding: 25px;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .converter-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            pointer-events: none;
        }

        .converter-card h4 {
            font-size: 18px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .converter-card .icon {
            font-size: 24px;
        }

        .converter-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
        }

        .converter-row {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .converter-select {
            flex: 1;
            padding: 10px 15px;
            border-radius: 8px;
            border: 2px solid rgba(255,255,255,0.3);
            background: rgba(255,255,255,0.1);
            color: white;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .converter-select:hover {
            background: rgba(255,255,255,0.2);
            border-color: rgba(255,255,255,0.5);
        }

        .converter-select option {
            background: #2d3748;
            color: white;
        }

        .converter-arrow {
            font-size: 24px;
            font-weight: bold;
            opacity: 0.8;
        }

        .converter-file-input {
            display: none;
        }

        .converter-btn {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            width: 100%;
            margin-top: 10px;
        }

        .converter-btn:hover {
            background: rgba(255,255,255,0.3);
            border-color: rgba(255,255,255,0.5);
            transform: translateY(-2px);
        }

        .converter-btn:active {
            transform: translateY(0);
        }

        .converter-status {
            margin-top: 15px;
            padding: 12px;
            border-radius: 8px;
            background: rgba(255,255,255,0.1);
            font-size: 13px;
            display: none;
        }

        .converter-status.show {
            display: block;
        }

        .converter-status.success {
            background: rgba(16, 185, 129, 0.3);
        }

        .converter-status.error {
            background: rgba(239, 68, 68, 0.3);
        }

        .converter-status.processing {
            background: rgba(59, 130, 246, 0.3);
        }

        .converter-progress {
            width: 100%;
            height: 4px;
            background: rgba(255,255,255,0.2);
            border-radius: 2px;
            margin-top: 10px;
            overflow: hidden;
        }

        .converter-progress-bar {
            height: 100%;
            background: rgba(255,255,255,0.8);
            border-radius: 2px;
            transition: width 0.3s;
        }

        /* YENİ UNIFIED CONVERTER STİLLERİ */
        .unified-converter {
            margin-top: 20px;
        }

        .conversion-type-select {
            width: 100%;
            padding: 15px 20px;
            font-size: 16px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            background: white;
            color: #333;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }

        .conversion-type-select:hover {
            border-color: #667eea;
        }

        .conversion-type-select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        body.dark-mode .conversion-type-select {
            background: #2d3748;
            color: white;
            border-color: #4a5568;
        }

        .conversion-type-select optgroup {
            font-weight: 600;
            color: #667eea;
        }

        .conversion-type-select option {
            padding: 10px;
        }

        .converter-area {
            margin-top: 30px;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .converter-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 16px;
            padding: 35px;
            color: white;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        body.dark-mode .converter-box {
            background: linear-gradient(135deg, #4c51bf 0%, #5a3d8a 100%);
        }

        .conversion-info {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 25px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
        }

        .conversion-flow {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 15px;
        }

        .format-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 16px;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .conversion-flow .arrow {
            font-size: 32px;
            opacity: 0.8;
        }

        .conversion-desc {
            font-size: 14px;
            opacity: 0.9;
            margin: 0;
        }

        .file-drop-zone {
            background: rgba(255, 255, 255, 0.1);
            border: 3px dashed rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            transition: all 0.3s;
            position: relative;
        }

        .file-drop-zone:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .file-drop-zone.drag-over {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.7);
            border-style: solid;
        }

        .drop-zone-content p {
            margin: 0;
            color: white;
        }

        .select-file-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.4);
            color: white;
            padding: 12px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 15px;
            transition: all 0.3s;
        }

        .select-file-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.6);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .selected-files {
            margin-top: 20px;
            display: none;
        }

        .selected-files.has-files {
            display: block;
        }

        .file-item {
            background: rgba(255, 255, 255, 0.15);
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .file-item-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .file-item-icon {
            font-size: 24px;
        }

        .file-item-name {
            font-weight: 500;
        }

        .file-item-size {
            font-size: 13px;
            opacity: 0.7;
        }

        .file-item-remove {
            background: rgba(239, 68, 68, 0.3);
            border: none;
            color: white;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s;
        }

        .file-item-remove:hover {
            background: rgba(239, 68, 68, 0.5);
        }

        .convert-button {
            width: 100%;
            background: rgba(16, 185, 129, 0.3);
            border: 2px solid rgba(16, 185, 129, 0.5);
            color: white;
            padding: 16px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 25px;
            transition: all 0.3s;
        }

        .convert-button:hover {
            background: rgba(16, 185, 129, 0.4);
            border-color: rgba(16, 185, 129, 0.7);
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(16, 185, 129, 0.3);
        }

        .convert-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .converter-status-unified {
            margin-top: 20px;
            padding: 16px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            display: none;
        }

        .converter-status-unified.show {
            display: block;
        }

        .converter-status-unified.success {
            background: rgba(16, 185, 129, 0.3);
            border: 2px solid rgba(16, 185, 129, 0.5);
        }

        .converter-status-unified.error {
            background: rgba(239, 68, 68, 0.3);
            border: 2px solid rgba(239, 68, 68, 0.5);
        }

        .converter-status-unified.processing {
            background: rgba(59, 130, 246, 0.3);
            border: 2px solid rgba(59, 130, 246, 0.5);
        }

        .progress-bar-container {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            margin-top: 12px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 4px;
            width: 0%;
            transition: width 0.3s;
        }

        .welcome-message {
            text-align: center;
            padding: 80px 20px;
            color: #999;
        }

        body.dark-mode .welcome-message {
            color: #666;
        }

        /* KOMPAKT MENÜ */
        .compact-menu-wrapper {
            position: relative;
        }

        .compact-menu-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 15px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }

        .compact-menu-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .compact-menu-dropdown {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            margin-top: 8px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            min-width: 280px;
            max-height: 70vh;
            overflow-y: auto;
            z-index: 1000;
            padding: 8px;
        }

        .compact-menu-dropdown.show {
            display: block;
            animation: slideDown 0.2s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        body.dark-mode .compact-menu-dropdown {
            background: #1e293b;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
        }

        .menu-category {
            margin-bottom: 8px;
        }

        .menu-category-title {
            font-size: 11px;
            font-weight: 700;
            color: #9ca3af;
            padding: 8px 12px;
            letter-spacing: 0.5px;
        }

        body.dark-mode .menu-category-title {
            color: #64748b;
        }

        .menu-item {
            width: 100%;
            background: transparent;
            border: none;
            padding: 12px 16px;
            text-align: left;
            font-size: 14px;
            color: #1f2937;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .menu-item:hover {
            background: #f3f4f6;
        }

        body.dark-mode .menu-item {
            color: #e5e7eb;
        }

        body.dark-mode .menu-item:hover {
            background: #334155;
        }

        .menu-item-danger {
            color: #ef4444;
        }

        .menu-item-danger:hover {
            background: rgba(239, 68, 68, 0.1);
        }

        .menu-divider {
            height: 1px;
            background: #e5e7eb;
            margin: 8px 0;
        }

        body.dark-mode .menu-divider {
            background: #334155;
        }

        .btn-compact {
            padding: 10px 14px;
            font-size: 16px;
        }

        /* KÜÇÜK İSTATİSTİKLER */
        .stats-grid-compact {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
            margin-bottom: 20px;
        }

        .stat-card-compact {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.3s;
        }

        .stat-card-compact:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        body.dark-mode .stat-card-compact {
            background: #1e293b;
        }

        .stat-icon {
            font-size: 28px;
            flex-shrink: 0;
        }

        .stat-number-compact {
            font-size: 20px;
            font-weight: 700;
            color: #1f2937;
        }

        body.dark-mode .stat-number-compact {
            color: #e5e7eb;
        }

        .stat-label-compact {
            font-size: 12px;
            color: #6b7280;
            margin-top: 2px;
        }

        body.dark-mode .stat-label-compact {
            color: #9ca3af;
        }

        @media (max-width: 768px) {
            .compact-menu-dropdown {
                left: auto;
                right: 0;
            }

            .stats-grid-compact {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* MODERN CONVERTER STİLLERİ */
        .modern-converter {
            max-width: 900px;
            margin: 0 auto;
        }

        .converter-step {
            background: white;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
            transition: all 0.3s;
        }

        body.dark-mode .converter-step {
            background: #1e293b;
        }

        .converter-step:not(.active) {
            opacity: 0.6;
            pointer-events: none;
        }

        .step-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e5e7eb;
        }

        body.dark-mode .step-header {
            border-bottom-color: #334155;
        }

        .step-number {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
            flex-shrink: 0;
        }

        .step-header h4 {
            margin: 0;
            font-size: 20px;
            font-weight: 600;
            color: #1f2937;
        }

        body.dark-mode .step-header h4 {
            color: #e5e7eb;
        }

        /* UPLOAD ZONE */
        .upload-zone {
            border: 3px dashed #d1d5db;
            border-radius: 16px;
            padding: 60px 30px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
            background: #f9fafb;
        }

        body.dark-mode .upload-zone {
            background: #0f172a;
            border-color: #334155;
        }

        .upload-zone:hover {
            border-color: #667eea;
            background: #f3f4f6;
        }

        body.dark-mode .upload-zone:hover {
            background: #1e293b;
            border-color: #667eea;
        }

        .upload-zone.drag-over {
            border-color: #667eea;
            background: #eef2ff;
            border-style: solid;
        }

        .upload-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }

        .upload-content h5 {
            font-size: 20px;
            font-weight: 600;
            margin: 0 0 10px 0;
            color: #1f2937;
        }

        body.dark-mode .upload-content h5 {
            color: #e5e7eb;
        }

        .upload-content p {
            color: #6b7280;
            margin: 0 0 20px 0;
        }

        .upload-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 14px 32px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .upload-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .supported-formats {
            margin-top: 25px;
            padding-top: 25px;
            border-top: 1px solid #e5e7eb;
        }

        body.dark-mode .supported-formats {
            border-top-color: #334155;
        }

        .supported-formats small {
            color: #9ca3af;
            font-size: 13px;
        }

        /* FILE INFO CARD */
        .file-info-card {
            display: flex;
            align-items: center;
            gap: 20px;
            background: #f3f4f6;
            padding: 20px;
            border-radius: 12px;
            margin-top: 20px;
        }

        body.dark-mode .file-info-card {
            background: #0f172a;
        }

        .file-icon {
            font-size: 48px;
            flex-shrink: 0;
        }

        .file-details {
            flex: 1;
        }

        .file-name {
            font-size: 16px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 5px;
            word-break: break-all;
        }

        body.dark-mode .file-name {
            color: #e5e7eb;
        }

        .file-meta {
            font-size: 13px;
            color: #6b7280;
        }

        .file-remove-btn {
            background: #ef4444;
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }

        .file-remove-btn:hover {
            background: #dc2626;
        }

        /* FORMAT GRID */
        .format-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 15px;
        }

        .format-option {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 25px 20px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .format-option:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .format-option.selected {
            background: #10b981;
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.3);
        }

        .format-option .format-icon {
            font-size: 36px;
            margin-bottom: 10px;
        }

        .format-option .format-name {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 4px;
        }

        .format-option .format-desc {
            font-size: 11px;
            opacity: 0.9;
        }

        /* VERSION SELECTOR */
        .version-selector {
            background: #f9fafb;
            padding: 25px;
            border-radius: 12px;
            border: 2px solid #e5e7eb;
        }

        body.dark-mode .version-selector {
            background: #0f172a;
            border-color: #334155;
        }

        .version-selector h5 {
            margin: 0 0 15px 0;
            color: #1f2937;
        }

        body.dark-mode .version-selector h5 {
            color: #e5e7eb;
        }

        .version-selector label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 13px;
            color: #6b7280;
        }

        .version-select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 14px;
            background: white;
            cursor: pointer;
        }

        body.dark-mode .version-select {
            background: #1e293b;
            border-color: #334155;
            color: #e5e7eb;
        }

        /* CONVERSION SUMMARY */
        .conversion-summary {
            text-align: center;
        }

        .conversion-flow-lg {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 30px;
            margin-bottom: 30px;
        }

        .format-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 40px;
            border-radius: 12px;
            font-size: 24px;
            font-weight: 600;
        }

        .arrow-lg {
            font-size: 40px;
            color: #667eea;
            font-weight: bold;
        }

        .convert-action-btn {
            background: #10b981;
            color: white;
            border: none;
            padding: 18px 50px;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .convert-action-btn:hover {
            background: #059669;
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.3);
        }

        /* CONVERSION STATUS */
        .conversion-status {
            margin-top: 30px;
            padding: 20px;
            border-radius: 12px;
            display: none;
        }

        .conversion-status.show {
            display: block;
        }

        .conversion-status.success {
            background: #d1fae5;
            color: #065f46;
            border: 2px solid #10b981;
        }

        .conversion-status.error {
            background: #fee2e2;
            color: #991b1b;
            border: 2px solid #ef4444;
        }

        .conversion-status.processing {
            background: #dbeafe;
            color: #1e40af;
            border: 2px solid #3b82f6;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(0,0,0,0.1);
            border-radius: 4px;
            margin-top: 12px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #10b981;
            border-radius: 4px;
            width: 0%;
            transition: width 0.3s;
        }

        @media (max-width: 768px) {
            .format-grid {
                grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
            }

            .conversion-flow-lg {
                flex-direction: column;
                gap: 15px;
            }

            .format-box {
                padding: 15px 30px;
                font-size: 20px;
            }

            .arrow-lg {
                transform: rotate(90deg);
                font-size: 32px;
            }
        }
            transition: width 0.3s;
            width: 0%;
        }

        @media (max-width: 1400px) {
            .admin-wrapper {
                grid-template-columns: 1fr;
            }
        }
        /* CHAT WIDGET */
        .chat-widget {
            position: fixed;
            bottom: 30px;
            left: 30px;
            z-index: 10000;
        }

        .chat-toggle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            position: relative;
            transition: transform 0.3s;
        }

        .chat-toggle:hover {
            transform: scale(1.1);
        }

        .chat-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #ef4444;
            color: white;
            border-radius: 50%;
            width: 22px;
            height: 22px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        .chat-window {
            position: absolute;
            bottom: 80px;
            left: 0;
            width: 350px;
            height: 500px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .chat-window.hidden {
            display: none;
        }

        .chat-header {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-header h3 {
            margin: 0;
            font-size: 16px;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #f8f9fa;
        }

        .chat-message {
            margin-bottom: 15px;
            display: flex;
            flex-direction: column;
        }

        .chat-message.bot {
            align-items: flex-start;
        }

        .chat-message.user {
            align-items: flex-end;
        }

        .message-content {
            background: white;
            padding: 10px 15px;
            border-radius: 10px;
            max-width: 70%;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .chat-message.user .message-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .message-time {
            font-size: 11px;
            color: #666;
            margin-top: 5px;
        }

        .chat-input-area {
            padding: 15px;
            background: white;
            border-top: 1px solid #e2e8f0;
            display: flex;
            gap: 10px;
        }

        .chat-input-area input {
            flex: 1;
            padding: 10px 15px;
            border: 1px solid #e2e8f0;
            border-radius: 20px;
            font-size: 14px;
        }

        .chat-input-area button {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            cursor: pointer;
            font-size: 18px;
        }

        @media (max-width: 480px) {
            .chat-window {
                width: calc(100vw - 40px);
                left: -10px;
            }
        }
        
        /* ========================================
           GELİŞMİŞ MOBİL RESPONSIVE - ADMIN PANEL
           ======================================== */
        
        @media (max-width: 1024px) {
            .admin-wrapper {
                grid-template-columns: 1fr !important;
                gap: 20px;
            }
            
            .preview-panel {
                display: none;
            }
            
            .admin-container {
                padding: 20px !important;
            }
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .admin-header {
                flex-wrap: wrap;
                gap: 15px;
            }
            
            .admin-header h1 {
                font-size: 22px !important;
            }
            
            .admin-actions {
                width: 100%;
                justify-content: space-between;
            }
            
            .stats-grid {
                grid-template-columns: 1fr !important;
                gap: 15px;
            }
            
            .zones-container {
                grid-template-columns: 1fr !important;
            }
            
            .upload-section {
                padding: 20px !important;
            }
            
            .form-group input, 
            .form-group textarea, 
            .form-group select {
                font-size: 15px !important;
            }
            
            .btn {
                width: 100%;
                padding: 12px !important;
                font-size: 14px !important;
            }
            
            .project-actions {
                flex-direction: column;
                gap: 8px;
            }
            
            .project-actions button {
                width: 100%;
            }
            
            .context-menu {
                min-width: 150px !important;
                font-size: 13px !important;
            }
            
            .context-menu-item {
                padding: 8px 12px !important;
            }
            
            button, a, .clickable {
                min-height: 44px;
                min-width: 44px;
            }
            
            .tabs {
                flex-wrap: nowrap;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
            
            .tab {
                flex-shrink: 0;
                min-width: 120px;
            }
        }
        
        @media (max-width: 480px) {
            .admin-header h1 {
                font-size: 20px !important;
            }
            
            .stat-card {
                padding: 15px !important;
            }
            
            .stat-value {
                font-size: 24px !important;
            }
            
            .modal-content {
                width: 95% !important;
                padding: 20px !important;
            }
        }
        
        * {
            -webkit-tap-highlight-color: transparent;
        }
        
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>

<!-- LOGIN -->
<div id="loginScreen" class="login-screen">
    <h1>🔐 Admin Girişi</h1>
    <div id="loginError" class="login-error"></div>
    <input type="text" id="username" placeholder="Kullanıcı Adı" value="admin" onkeypress="if(event.key==='Enter') login()">
    <input type="password" id="password" placeholder="Şifre" value="admin123" onkeypress="if(event.key==='Enter') login()">
    <button onclick="login()">Giriş Yap</button>
    <div style="display: flex; gap: 10px; margin-top: 15px;">
        <button onclick="forgotPassword()" style="flex: 1; background: #6c757d;">Şifremi Unuttum</button>
        <button onclick="changePassword()" style="flex: 1; background: #0dcaf0;">Şifre Değiştir</button>
    </div>
    <p style="text-align: center; margin-top: 20px; font-size: 12px; color: #999;">
        Varsayılan: admin / admin123
    </p>
</div>

<!-- SİTE AYARLARI MODALI -->
<div id="siteSettingsModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; overflow-y: auto;">
    <div style="max-width: 900px; margin: 30px auto; background: white; border-radius: 16px; padding: 30px;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; border-bottom: 2px solid #e5e7eb; padding-bottom: 15px;">
            <h2 style="margin: 0; color: #667eea;">⚙️ Site Ayarları</h2>
            <button onclick="closeSiteSettings()" style="background: #f3f4f6; border: none; width: 36px; height: 36px; border-radius: 8px; cursor: pointer; font-size: 20px;">×</button>
        </div>
        
        <!-- TABS -->
        <div style="display: flex; gap: 10px; margin-bottom: 25px; border-bottom: 1px solid #e5e7eb;">
            <button onclick="switchSettingsTab('logo')" id="logoTabBtn" class="settings-tab-btn active" style="padding: 10px 20px; border: none; background: none; cursor: pointer; font-weight: 600; color: #667eea; border-bottom: 3px solid #667eea;">
                🖼️ Logo
            </button>
            <button onclick="switchSettingsTab('hero')" id="heroTabBtn" class="settings-tab-btn" style="padding: 10px 20px; border: none; background: none; cursor: pointer; font-weight: 600; color: #666; border-bottom: 3px solid transparent;">
                🎨 Hero Yazıları
            </button>
            <button onclick="switchSettingsTab('social')" id="socialTabBtn" class="settings-tab-btn" style="padding: 10px 20px; border: none; background: none; cursor: pointer; font-weight: 600; color: #666; border-bottom: 3px solid transparent;">
                📱 Sosyal Medya
            </button>
            <button onclick="switchSettingsTab('team')" id="teamTabBtn" class="settings-tab-btn" style="padding: 10px 20px; border: none; background: none; cursor: pointer; font-weight: 600; color: #666; border-bottom: 3px solid transparent;">
                👥 Ekip
            </button>
            <button onclick="switchSettingsTab('colors')" id="colorsTabBtn" class="settings-tab-btn" style="padding: 10px 20px; border: none; background: none; cursor: pointer; font-weight: 600; color: #666; border-bottom: 3px solid transparent;">
                🎨 Renkler
            </button>
        </div>
        
        <!-- LOGO TAB -->
        <div id="logoTab" class="settings-tab-content">
            <h3 style="color: #333; margin-bottom: 20px;">Site Logosu</h3>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #666;">Logo Resmi Yükle:</label>
                <input type="file" id="logoUpload" accept="image/*" onchange="handleLogoUpload(this)" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; cursor: pointer;">
                <p style="font-size: 12px; color: #999; margin-top: 5px;">PNG veya JPG formatında, şeffaf arka planlı logo önerilir.</p>
            </div>
            
            <div id="logoPreview" style="margin-bottom: 20px; padding: 30px; background: #f9fafb; border: 2px dashed #e5e7eb; border-radius: 8px; text-align: center; min-height: 150px; display: flex; align-items: center; justify-content: center;">
                <div id="logoPreviewContent" style="color: #999;">Logo yüklenmedi</div>
            </div>
            
            <button onclick="removeLogo()" style="width: 100%; padding: 15px; background: #ef4444; color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 16px; margin-bottom: 10px;">
                🗑️ Logoyu Kaldır
            </button>
        </div>
        
        <!-- HERO TAB -->
        <div id="heroTab" class="settings-tab-content" style="display: none;">
            <h3 style="color: #333; margin-bottom: 20px;">Ana Sayfa Hero Bölümü</h3>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #666;">Başlık Metni:</label>
                <input type="text" id="heroTitle" value="MİMARLIK" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 16px;">
            </div>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #666;">Alt Metin:</label>
                <input type="text" id="heroSubtitle" value="Hayallerinizi gerçeğe dönüştürüyoruz" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 16px;">
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #666;">Font Boyutu:</label>
                    <input type="range" id="heroFontSize" min="40" max="100" value="72" oninput="document.getElementById('fontSizeValue').textContent=this.value+'px'" style="width: 100%;">
                    <span id="fontSizeValue" style="color: #667eea; font-weight: 600;">72px</span>
                </div>
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #666;">Font Kalınlığı:</label>
                    <select id="heroFontWeight" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
                        <option value="300">İnce (300)</option>
                        <option value="400">Normal (400)</option>
                        <option value="600">Kalın (600)</option>
                        <option value="700" selected>Çok Kalın (700)</option>
                        <option value="900">En Kalın (900)</option>
                    </select>
                </div>
            </div>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #666;">Yazı Rengi:</label>
                <input type="color" id="heroColor" value="#ffffff" style="width: 100%; height: 50px; border: 2px solid #e5e7eb; border-radius: 8px; cursor: pointer;">
            </div>
            
            <button onclick="saveHeroSettings()" style="width: 100%; padding: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 16px;">
                💾 Hero Ayarlarını Kaydet
            </button>
        </div>
        
        <!-- SOCIAL TAB -->
        <div id="socialTab" class="settings-tab-content" style="display: none;">
            <h3 style="color: #333; margin-bottom: 20px;">Sosyal Medya Linkleri</h3>
            
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #666;">📷 Instagram:</label>
                <input type="url" id="instagramLink" placeholder="https://instagram.com/ceemimarlik" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
            </div>
            
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #666;">📘 Facebook:</label>
                <input type="url" id="facebookLink" placeholder="https://facebook.com/ceemimarlik" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
            </div>
            
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #666;">💼 LinkedIn:</label>
                <input type="url" id="linkedinLink" placeholder="https://linkedin.com/company/ceemimarlik" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
            </div>
            
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #666;">🐦 Twitter/X:</label>
                <input type="url" id="twitterLink" placeholder="https://twitter.com/ceemimarlik" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
            </div>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #666;">📺 YouTube:</label>
                <input type="url" id="youtubeLink" placeholder="https://youtube.com/@ceemimarlik" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
            </div>
            
            <button onclick="saveSocialLinks()" style="width: 100%; padding: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 16px;">
                💾 Sosyal Medya Kaydet
            </button>
        </div>
        
        <!-- TEAM TAB -->
        <div id="teamTab" class="settings-tab-content" style="display: none;">
            <h3 style="color: #333; margin-bottom: 20px;">Ekip/Hakkımızda Yönetimi</h3>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #666;">Bölüm Başlığı:</label>
                <input type="text" id="teamSectionTitle" value="Uzman Kadromuz" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
            </div>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #666;">Bölüm Açıklaması:</label>
                <textarea id="teamSectionDesc" rows="3" placeholder="Deneyimli ekibimizle..." style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; resize: vertical;"></textarea>
            </div>
            
            <div style="background: #f9fafb; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <h4 style="margin: 0 0 15px 0; color: #667eea;">➕ Yeni Ekip Üyesi Ekle</h4>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #666;">Ad Soyad:</label>
                    <input type="text" id="teamMemberName" placeholder="Ahmet Yılmaz" style="width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 8px;">
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #666;">Ünvan:</label>
                    <input type="text" id="teamMemberTitle" placeholder="Baş Mimar" style="width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 8px;">
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #666;">Açıklama:</label>
                    <textarea id="teamMemberDesc" rows="2" placeholder="15 yıllık deneyim..." style="width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 8px; resize: vertical;"></textarea>
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #666;">Fotoğraf:</label>
                    <input type="file" id="teamMemberPhoto" accept="image/*" style="width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 8px;">
                </div>
                
                <button onclick="addTeamMember()" style="width: 100%; padding: 12px; background: #10b981; color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">
                    ➕ Ekip Üyesi Ekle
                </button>
            </div>
            
            <div id="teamMembersList" style="margin-top: 20px;">
                <!-- Ekip üyeleri buraya listelenecek -->
            </div>
            
            <button onclick="saveTeamSettings()" style="width: 100%; padding: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 16px; margin-top: 20px;">
                💾 Ekip Ayarlarını Kaydet
            </button>
        </div>
        
        <!-- COLORS TAB -->
        <div id="colorsTab" class="settings-tab-content" style="display: none;">
            <h3 style="color: #333; margin-bottom: 20px;">Site Renk Yönetimi</h3>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #666;">Ana Renk (Primary):</label>
                <input type="color" id="primaryColor" value="#667eea" style="width: 100%; height: 60px; border: 2px solid #e5e7eb; border-radius: 8px; cursor: pointer;">
                <small style="color: #999;">Butonlar, linkler, vurgular</small>
            </div>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #666;">İkincil Renk (Secondary):</label>
                <input type="color" id="secondaryColor" value="#764ba2" style="width: 100%; height: 60px; border: 2px solid #e5e7eb; border-radius: 8px; cursor: pointer;">
                <small style="color: #999;">Gradient'ler, arkaplanlar</small>
            </div>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #666;">Accent Renk:</label>
                <input type="color" id="accentColor" value="#10b981" style="width: 100%; height: 60px; border: 2px solid #e5e7eb; border-radius: 8px; cursor: pointer;">
                <small style="color: #999;">Özel vurgular, başarı mesajları</small>
            </div>
            
            <button onclick="saveColorSettings()" style="width: 100%; padding: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 16px;">
                💾 Renk Ayarlarını Kaydet
            </button>
            
            <button onclick="resetColors()" style="width: 100%; padding: 12px; background: #f3f4f6; color: #666; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; margin-top: 10px;">
                🔄 Varsayılan Renklere Dön
            </button>
        </div>
    </div>
</div>

<!-- ADMIN PANEL -->
<div id="adminPanel" class="admin-wrapper hidden">
    <div class="admin-container">
        <div class="admin-header">
            <div class="logo-section">
                <img id="mainLogoPrev" src="https://via.placeholder.com/80" class="logo-preview">
                <div class="logo-info">
                    <h2>CEE Yönetim Paneli</h2>
                </div>
            </div>
            <div style="display: flex; gap: 10px; align-items: center;">
                <!-- KOMPAKT MENÜ -->
                <div class="compact-menu-wrapper">
                    <button class="compact-menu-btn" onclick="toggleCompactMenu()">
                        ☰ İşlemler <span style="font-size: 12px; opacity: 0.8;">(15)</span>
                    </button>
                    <div id="compactMenu" class="compact-menu-dropdown">
                        <!-- GENEL -->
                        <div class="menu-category">
                            <div class="menu-category-title">📋 GENEL</div>
                            <button class="menu-item" onclick="window.location.href='index.html'; closeCompactMenu();">
                                🏠 Ana Sayfa
                            </button>
                            <button class="menu-item" onclick="window.open('index.html', '_blank'); closeCompactMenu();">
                                👁️ Önizle
                            </button>
                            <button class="menu-item" onclick="openSiteSettings(); closeCompactMenu();">
                                ⚙️ Site Ayarları
                            </button>
                            <button class="menu-item" onclick="showKeyboardHelp(); closeCompactMenu();">
                                ⌨️ Klavye Kısayolları
                            </button>
                        </div>

                        <!-- DOSYA İŞLEMLERİ -->
                        <div class="menu-category">
                            <div class="menu-category-title">📁 DOSYA İŞLEMLERİ</div>
                            <button class="menu-item" onclick="document.getElementById('logoInput').click(); closeCompactMenu();">
                                🎨 Logo Yükle
                            </button>
                            <button class="menu-item" onclick="document.getElementById('projectInput').click(); closeCompactMenu();">
                                ➕ Yeni Proje Ekle
                            </button>
                            <button class="menu-item" onclick="document.getElementById('miniConverterFile').click(); closeCompactMenu();">
                                🔄 Dosya Dönüştür
                            </button>
                        </div>

                        <!-- YEDEKLEME -->
                        <div class="menu-category">
                            <div class="menu-category-title">💾 YEDEKLEME</div>
                            <button class="menu-item" onclick="exportData(); closeCompactMenu();">
                                📥 Veri Yedekle
                            </button>
                            <button class="menu-item" onclick="importData(); closeCompactMenu();">
                                📤 Veri Geri Yükle
                            </button>
                            <button class="menu-item" onclick="exportToPDF(); closeCompactMenu();">
                                📄 PDF Katalog
                            </button>
                            <button class="menu-item" onclick="yandexDiskBackup(); closeCompactMenu();">
                                ☁️ Yandex Yedek
                            </button>
                        </div>

                        <!-- AYARLAR -->
                        <div class="menu-category">
                            <div class="menu-category-title">🎨 GÖRÜNÜM</div>
                            <button class="menu-item" onclick="toggleDarkMode(); closeCompactMenu();" id="darkModeMenuItem">
                                🌙 Dark Mode
                            </button>
                            <button class="menu-item" onclick="toggleSortMode(); closeCompactMenu();" id="sortModeMenuItem">
                                🔢 Otomatik Sıralama
                            </button>
                        </div>

                        <!-- ÇIKIŞ -->
                        <div class="menu-divider"></div>
                        <button class="menu-item menu-item-danger" onclick="logout();">
                            🚪 Çıkış Yap
                        </button>
                    </div>
                </div>

                <!-- HIZLI BUTONLAR (sadece önemliler) -->
                <button class="btn btn-success btn-compact" onclick="window.open('index.html', '_blank')" title="Önizle">👁️</button>
                <button class="btn btn-info btn-compact" onclick="toggleDarkMode()" id="darkModeBtn" title="Dark Mode">🌙</button>
                <button class="btn btn-warning btn-compact" id="undoBtn" onclick="undoDelete()" style="display: none;" title="Geri Al">↩️</button>
                <button class="btn btn-danger btn-compact" onclick="logout()" title="Çıkış">🚪</button>
            </div>
        </div>

        <!-- HIDDEN INPUTS -->
        <input type="file" id="logoInput" accept="image/*" style="display: none;">
        <input type="file" id="projectInput" accept="image/*,video/mp4,video/webm,video/mov" multiple style="display: none;">
        <input type="file" id="miniConverterFile" style="display: none;" onchange="handleMiniConverter(this)">

        <!-- MİNİ CONVERTER SATIRI (kompakt) -->
        <div id="miniConverterBar" style="display: none; background: linear-gradient(135deg, #667eea, #764ba2); padding: 15px; margin-bottom: 20px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
            <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                <span style="color: white; font-weight: 600; font-size: 14px;">🔄 Dönüştürücü:</span>
                <select id="miniConverterFormat" style="padding: 8px 12px; border: 2px solid rgba(255,255,255,0.3); border-radius: 6px; background: rgba(255,255,255,0.2); color: white; font-weight: 600; font-size: 13px;">
                    <option value="">Format Seçin →</option>
                </select>
                <button class="btn btn-success btn-sm" id="miniConvertBtn" onclick="executeMiniConvert()" style="display: none;">
                    Dönüştür
                </button>
                <span id="miniConverterStatus" style="color: white; font-size: 13px; flex: 1;"></span>
                <button onclick="closeMiniConverter()" style="background: rgba(239,68,68,0.8); border: none; color: white; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 12px;">
                    ✕ Kapat
                </button>
            </div>
        </div>

        <!-- KÜÇÜK İSTATİSTİKLER -->
        <div class="stats-grid-compact">
            <div class="stat-card-compact">
                <span class="stat-icon">📊</span>
                <div>
                    <div class="stat-number-compact" id="totalProjects">0</div>
                    <div class="stat-label-compact">Toplam</div>
                </div>
            </div>
            <div class="stat-card-compact">
                <span class="stat-icon">⭐</span>
                <div>
                    <div class="stat-number-compact" id="showcaseProjects">0</div>
                    <div class="stat-label-compact">Vitrin</div>
                </div>
            </div>
            <div class="stat-card-compact">
                <span class="stat-icon">📦</span>
                <div>
                    <div class="stat-number-compact" id="archiveProjects">0</div>
                    <div class="stat-label-compact">Arşiv</div>
                </div>
            </div>
            <div class="stat-card-compact">
                <span class="stat-icon">⭐</span>
                <div>
                    <div class="stat-number-compact" id="favoriteProjects">0</div>
                    <div class="stat-label-compact">Favori</div>
                </div>
            </div>
            <div class="stat-card-compact">
                <span class="stat-icon">💾</span>
                <div>
                    <div class="stat-number-compact" id="totalSize">0 MB</div>
                    <div class="stat-label-compact">Boyut</div>
                </div>
            </div>
            <div class="stat-card-compact">
                <span class="stat-icon">👁️</span>
                <div>
                    <div class="stat-number-compact" id="totalClicks">0</div>
                    <div class="stat-label-compact">Görüntülenme</div>
                </div>
            </div>
        </div>
        <div class="zone-container">
            <div class="zone-header">
                <h4>⭐ VİTRİN PROJELERİ</h4>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <span id="topCount">0 Proje</span>
                    <button class="btn btn-danger" style="padding: 6px 12px; font-size: 12px;" onclick="clearZone('top')">
                        🗑️ Tümünü Sil
                    </button>
                </div>
            </div>
            <div id="topZone" class="zone-content" 
                ondrop="handleFileDrop(event, 'top')" 
                ondragover="allowDrop(event)" 
                ondragleave="dragLeave(event)">
                <div class="empty-message">Henüz proje eklenmedi</div>
            </div>
        </div>

        <div class="zone-container">
            <div class="zone-header">
                <h4>📁 ARŞİV PROJELERİ</h4>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <span id="bottomCount">0 Proje</span>
                    <button class="btn btn-danger" style="padding: 6px 12px; font-size: 12px;" onclick="clearZone('bottom')">
                        🗑️ Tümünü Sil
                    </button>
                </div>
            </div>
            <div id="bottomZone" class="zone-content" 
                ondrop="handleFileDrop(event, 'bottom')" 
                ondragover="allowDrop(event)" 
                ondragleave="dragLeave(event)">
                <div class="empty-message">Henüz proje eklenmedi</div>
            </div>
        </div>
    </div>

    <!-- PREVIEW -->
    <div class="preview-panel">
        <div class="preview-header">
            <h3>👁️ Canlı Ön İzleme</h3>
            <div class="preview-tabs">
                <button class="preview-tab active" onclick="switchPreview('mobile', this)">📱 Mobil</button>
                <button class="preview-tab" onclick="switchPreview('desktop', this)">🖥️ Masaüstü</button>
            </div>
        </div>
        
        <div class="preview-content">
            <div id="mobilePreview" class="preview-mode active">
                <div class="mobile-frame">
                    <div class="mobile-screen">
                        <div class="preview-section-title">⭐ VİTRİN</div>
                        <div id="mobileTopPreview" class="preview-project-grid"></div>
                        <div class="preview-section-title">📁 ARŞİV</div>
                        <div id="mobileBottomPreview" class="preview-project-grid"></div>
                    </div>
                </div>
            </div>

            <div id="desktopPreview" class="preview-mode desktop-preview">
                <div class="preview-section-title">⭐ VİTRİN</div>
                <div id="desktopTopPreview" class="preview-project-grid"></div>
                <div class="preview-section-title">📁 ARŞİV</div>
                <div id="desktopBottomPreview" class="preview-project-grid"></div>
            </div>
        </div>
    </div>
</div>

<!-- FULLSCREEN MODAL -->
<div id="fullscreenModal" class="fullscreen-modal" onclick="closeFullscreen()">
    <button class="fullscreen-close">✕ Kapat</button>
    <div class="fullscreen-content" onclick="event.stopPropagation()">
        <img id="fullscreenLogo" class="fullscreen-logo" src="" alt="Logo" style="display: none;">
        <img id="fullscreenImg" class="main-img" src="" alt="Fullscreen">
    </div>
</div>

<!-- CONTEXT MENU (SAĞ TIK) -->
<div id="contextMenu" class="context-menu">
    <div class="context-menu-item" onclick="contextAction('fullscreen')">🖼️ Tam Ekran</div>
    <div class="context-menu-item" onclick="contextAction('favorite')">⭐ Favori</div>
    <div class="context-menu-item" onclick="contextAction('edit')">✏️ Başlık Düzenle</div>
    <div class="context-menu-item" onclick="contextAction('tag')">🏷️ Etiket Ekle</div>
    <div class="context-menu-divider"></div>
    <div class="context-menu-item" onclick="contextAction('moveTop')">⬆️ Vitrin'e Taşı</div>
    <div class="context-menu-item" onclick="contextAction('moveBottom')">⬇️ Arşiv'e Taşı</div>
    <div class="context-menu-divider"></div>
    <div class="context-menu-item" onclick="contextAction('delete')" style="color: #ef4444;">🗑️ Sil</div>
</div>

<script>
// ============================================
// 🔒 GELİŞMİŞ GÜVENLİK SİSTEMİ
// ============================================

// AUTH
let isAuthenticated = false;

// Kullanıcı bilgilerini localStorage'dan yükle
let credentials = {
    username: 'admin',
    password: 'admin123',
    email: '',
    phone: ''
};

try {
    const saved = localStorage.getItem('cee_credentials');
    if (saved) {
        credentials = JSON.parse(saved);
    }
} catch (e) {}

function saveCredentials() {
    try {
        localStorage.setItem('cee_credentials', JSON.stringify(credentials));
    } catch (e) {}
}

// Brute Force Koruması
const LoginSecurity = {
    attempts: 0,
    maxAttempts: 5,
    lockoutTime: 300000, // 5 dakika
    lockoutUntil: 0,
    
    addAttempt() {
        this.attempts++;
        if (this.attempts >= this.maxAttempts) {
            this.lockoutUntil = Date.now() + this.lockoutTime;
            console.warn('⚠️ Hesap kilitlendi:', new Date(this.lockoutUntil));
        }
    },
    
    isLocked() {
        if (this.lockoutUntil > Date.now()) {
            return true;
        }
        if (this.lockoutUntil > 0 && this.lockoutUntil <= Date.now()) {
            this.reset();
        }
        return false;
    },
    
    getRemainingTime() {
        const remaining = Math.ceil((this.lockoutUntil - Date.now()) / 1000);
        return remaining > 0 ? remaining : 0;
    },
    
    reset() {
        this.attempts = 0;
        this.lockoutUntil = 0;
    }
};

// Session Yönetimi
const SessionManager = {
    sessionTimeout: 3600000, // 1 saat
    lastActivity: Date.now(),
    
    updateActivity() {
        this.lastActivity = Date.now();
        sessionStorage.setItem('last_activity', this.lastActivity.toString());
    },
    
    isExpired() {
        const stored = sessionStorage.getItem('last_activity');
        if (!stored) return true;
        
        const lastActivity = parseInt(stored);
        return (Date.now() - lastActivity) > this.sessionTimeout;
    },
    
    init() {
        setInterval(() => {
            if (isAuthenticated && this.isExpired()) {
                alert('⏱️ Oturumunuz zaman aşımına uğradı. Lütfen tekrar giriş yapın.');
                logout();
            }
        }, 30000);
        
        ['mousedown', 'keydown', 'scroll', 'touchstart'].forEach(event => {
            document.addEventListener(event, () => {
                if (isAuthenticated) {
                    this.updateActivity();
                }
            });
        });
    }
};

// XSS Koruması
function sanitizeInput(input) {
    const div = document.createElement('div');
    div.textContent = input;
    return div.innerHTML;
}

// CSRF Token
const CSRFToken = {
    token: null,
    
    generate() {
        const array = new Uint8Array(32);
        crypto.getRandomValues(array);
        this.token = Array.from(array, byte => byte.toString(16).padStart(2, '0')).join('');
        sessionStorage.setItem('csrf_token', this.token);
        return this.token;
    },
    
    validate(token) {
        return token === this.token;
    },
    
    get() {
        if (!this.token) {
            this.token = sessionStorage.getItem('csrf_token');
            if (!this.token) {
                this.generate();
            }
        }
        return this.token;
    }
};

// Güvenli Login
function login() {
    const userEl = document.getElementById('username');
    const passEl = document.getElementById('password');
    const loginScreenEl = document.getElementById('loginScreen');
    const adminPanelEl = document.getElementById('adminPanel');
    const errEl = document.getElementById('loginError');
    
    if (!userEl || !passEl) {
        console.error('Login elements not found');
        return;
    }
    
    // Lockout kontrolü
    if (LoginSecurity.isLocked()) {
        const remaining = LoginSecurity.getRemainingTime();
        if (errEl) {
            errEl.textContent = `🔒 Çok fazla başarısız deneme! ${remaining} saniye bekleyin.`;
            errEl.style.display = 'block';
            errEl.style.background = '#ff5252';
        }
        return;
    }
    
    const user = userEl.value.trim();
    const pass = passEl.value;
    
    // Input validation
    if (!user || !pass) {
        if (errEl) {
            errEl.textContent = '⚠️ Kullanıcı adı ve şifre gerekli!';
            errEl.style.display = 'block';
            setTimeout(() => errEl.style.display = 'none', 3000);
        }
        return;
    }
    
    // XSS koruması
    const sanitizedUser = sanitizeInput(user);
    
    if (sanitizedUser === credentials.username && pass === credentials.password) {
        // Başarılı giriş
        LoginSecurity.reset();
        isAuthenticated = true;
        
        // Session oluştur
        const sessionToken = CSRFToken.generate();
        sessionStorage.setItem('admin_session', sessionToken);
        sessionStorage.setItem('admin_login_time', Date.now().toString());
        SessionManager.updateActivity();
        
        if (loginScreenEl) loginScreenEl.classList.add('hidden');
        if (adminPanelEl) adminPanelEl.classList.remove('hidden');
        
        console.log('%c✅ Admin girişi başarılı', 'color: #4CAF50; font-weight: bold');
        
        init();
    } else {
        // Başarısız giriş
        LoginSecurity.addAttempt();
        
        if (errEl) {
            const remaining = LoginSecurity.maxAttempts - LoginSecurity.attempts;
            if (remaining > 0) {
                errEl.textContent = `❌ Hatalı kullanıcı adı veya şifre! (${remaining} deneme hakkı)`;
            } else {
                errEl.textContent = '🔒 Hesap kilitlendi! 5 dakika bekleyin.';
                errEl.style.background = '#ff5252';
            }
            errEl.style.display = 'block';
            setTimeout(() => errEl.style.display = 'none', 5000);
        }
        
        console.warn('⚠️ Başarısız giriş denemesi', {
            attempts: LoginSecurity.attempts,
            maxAttempts: LoginSecurity.maxAttempts
        });
    }
}

// Güvenli Logout
function logout() {
    if (confirm('Çıkış yapmak istediğiniz emin misiniz?')) {
        isAuthenticated = false;
        
        // Session temizle
        sessionStorage.removeItem('admin_session');
        sessionStorage.removeItem('csrf_token');
        sessionStorage.removeItem('admin_login_time');
        sessionStorage.removeItem('last_activity');
        
        const loginScreenEl = document.getElementById('loginScreen');
        const adminPanelEl = document.getElementById('adminPanel');
        const userEl = document.getElementById('username');
        const passEl = document.getElementById('password');
        
        if (loginScreenEl) loginScreenEl.classList.remove('hidden');
        if (adminPanelEl) adminPanelEl.classList.add('hidden');
        if (userEl) userEl.value = '';
        if (passEl) passEl.value = '';
        
        console.log('%c👋 Güvenli çıkış yapıldı', 'color: #FF9800; font-weight: bold');
    }
}

// ŞİFRE DEĞİŞTİRME
function changePassword() {
    const currentUser = prompt('Mevcut kullanıcı adınızı girin:');
    if (!currentUser) return;
    
    const currentPass = prompt('Mevcut şifrenizi girin:');
    if (!currentPass) return;
    
    if (currentUser !== credentials.username || currentPass !== credentials.password) {
        alert('❌ Hatalı kullanıcı adı veya şifre!');
        return;
    }
    
    const newUser = prompt('Yeni kullanıcı adı girin:', credentials.username);
    if (!newUser) return;
    
    const newPass = prompt('Yeni şifre girin (min 6 karakter):');
    if (!newPass || newPass.length < 6) {
        alert('❌ Şifre en az 6 karakter olmalı!');
        return;
    }
    
    const confirmPass = prompt('Yeni şifreyi tekrar girin:');
    if (newPass !== confirmPass) {
        alert('❌ Şifreler eşleşmiyor!');
        return;
    }
    
    const phone = prompt('Telefon numaranızı girin (opsiyonel):\nÖrnek: 0555 123 4567', credentials.phone || '');
    const email = prompt('Email adresinizi girin (opsiyonel):', credentials.email || '');
    
    credentials.username = newUser;
    credentials.password = newPass;
    credentials.email = email || '';
    credentials.phone = phone || '';
    saveCredentials();
    
    let infoText = '✅ Bilgileriniz güncellendi!\n\n';
    infoText += 'Kullanıcı: ' + newUser + '\n';
    if (phone) infoText += 'Telefon: ' + phone + '\n';
    if (email) infoText += 'Email: ' + email;
    
    alert(infoText);
}

// ŞİFREMİ UNUTTUM
function forgotPassword() {
    if (credentials.phone) {
        const phoneInput = prompt('🔐 ŞİFRE SIFIRLAMA\n\nKayıtlı telefon numaranızın son 4 hanesini girin:\n\nKayıtlı: ' + credentials.phone);
        
        if (!phoneInput) return;
        
        const lastFour = credentials.phone.replace(/\D/g, '').slice(-4);
        const inputFour = phoneInput.replace(/\D/g, '').slice(-4);
        
        if (lastFour !== inputFour) {
            alert('❌ Hatalı telefon numarası!');
            return;
        }
    }
    
    const confirmReset = confirm('⚠️ UYARI!\n\nŞifrenizi varsayılan değerlere sıfırlamak istiyor musunuz?\n\nKullanıcı: admin\nŞifre: admin123');
    
    if (confirmReset) {
        credentials.username = 'admin';
        credentials.password = 'admin123';
        saveCredentials();
        
        let resetMsg = '✅ Şifre sıfırlandı!\n\nKullanıcı: admin\nŞifre: admin123\n\n';
        if (credentials.phone) {
            resetMsg += '📱 Kayıtlı telefon: ' + credentials.phone + '\n';
        }
        resetMsg += '\nŞimdi giriş yapıp yeni şifre belirleyin!';
        
        alert(resetMsg);
    }
}

// DATA
let projects = [];
let siteLogo = '';
let draggedId = null;
let deletedProjects = []; // Son silinen projeler
let clearedZones = []; // Toplu silinen zoneler (array - birden fazla)

try {
    const savedProjects = localStorage.getItem('cee_projects');
    if (savedProjects) {
        const parsed = JSON.parse(savedProjects);
        // Validation: Array mi ve içinde valid projeler var mı?
        if (Array.isArray(parsed)) {
            // Her projeyi validate et, bozuk olanları at
            projects = parsed.filter(p => p && p.id && p.img && p.row).map(p => ({
                ...p,
                clickCount: p.clickCount || 0,
                favorite: p.favorite || false,
                tags: Array.isArray(p.tags) ? p.tags : [],
                title: p.title || '',
                mediaType: p.mediaType || 'image'
            }));
        }
    }
    siteLogo = localStorage.getItem('cee_site_logo') || '';
} catch (e) {
    console.error('LocalStorage yükleme hatası:', e);
    // Bozuk veri varsa temizle
    if (confirm('⚠️ Veri yükleme hatası!\n\nVerileriniz bozulmuş olabilir.\n\nSıfırlamak ister misiniz?\n\n(HAYIR derseniz boş başlarsınız)')) {
        try {
            localStorage.removeItem('cee_projects');
            localStorage.removeItem('cee_site_logo');
        } catch (err) {}
    }
    projects = [];
    siteLogo = '';
}

function init() {
    loadLogo();
    loadDarkMode();
    updateSortModeButton();
    render();
    updateStats();
    updatePreview();
    updateUndoButton();
}

function loadLogo() {
    const mainLogo = document.getElementById('mainLogoPrev');
    if (mainLogo && siteLogo) {
        mainLogo.src = siteLogo;
    }
    
    // Butonları güncelle
    setTimeout(() => {
        const uploadBtn = document.getElementById('logoUploadBtn');
        const removeBtn = document.getElementById('logoRemoveBtn');
        const status = document.getElementById('logoStatus');
        
        if (uploadBtn && removeBtn && status) {
            if (siteLogo) {
                uploadBtn.textContent = 'Logo Değiştir';
                uploadBtn.className = 'btn btn-primary';
                removeBtn.style.display = 'inline-block';
                status.textContent = '✅ Logo aktif';
                status.style.color = '#10b981';
            } else {
                uploadBtn.textContent = 'Logo Ekle';
                uploadBtn.className = 'btn btn-success';
                removeBtn.style.display = 'none';
                status.textContent = '';
            }
        }
    }, 100);
}

function removeLogo() {
    if (!confirm('Logoyu kaldırmak istediğinize emin misiniz?')) return;
    
    siteLogo = '';
    try {
        localStorage.removeItem('cee_site_logo');
    } catch (e) {}
    
    const mainLogo = document.getElementById('mainLogoPrev');
    if (mainLogo) {
        mainLogo.src = 'https://via.placeholder.com/80';
    }
    
    render();
    updatePreview();
    
    // Butonları güncelle
    const uploadBtn = document.getElementById('logoUploadBtn');
    const removeBtn = document.getElementById('logoRemoveBtn');
    const status = document.getElementById('logoStatus');
    
    if (uploadBtn) {
        uploadBtn.textContent = 'Logo Ekle';
        uploadBtn.className = 'btn btn-success';
    }
    if (removeBtn) {
        removeBtn.style.display = 'none';
    }
    if (status) {
        status.textContent = '';
    }
    
    alert('✅ Logo kaldırıldı!');
}

// Logo input'a otomatik dinleyici ekle
document.addEventListener('DOMContentLoaded', function() {
    const logoInput = document.getElementById('logoInput');
    if (logoInput) {
        logoInput.addEventListener('change', function() {
            uploadLogo();
        });
    }
});

function uploadLogo() {
    const input = document.getElementById('logoInput');
    if (!input.files || !input.files[0]) {
        return;
    }

    const reader = new FileReader();
    reader.onload = (e) => {
        siteLogo = e.target.result;
        try {
            localStorage.setItem('cee_site_logo', siteLogo);
        } catch (err) {}
        
        const mainLogo = document.getElementById('mainLogoPrev');
        if (mainLogo) {
            mainLogo.src = siteLogo;
        }
        
        render();
        updatePreview();
        
        // Butonları güncelle
        const uploadBtn = document.getElementById('logoUploadBtn');
        const removeBtn = document.getElementById('logoRemoveBtn');
        const status = document.getElementById('logoStatus');
        
        if (uploadBtn) {
            uploadBtn.textContent = 'Logo Değiştir';
            uploadBtn.className = 'btn btn-primary';
        }
        if (removeBtn) {
            removeBtn.style.display = 'inline-block';
        }
        if (status) {
            status.textContent = '✅ Logo aktif';
            status.style.color = '#10b981';
        }
        
        alert('✅ Logo güncellendi!');
        input.value = '';
    };
    reader.readAsDataURL(input.files[0]);
}

function addNewProject() {
    const input = document.getElementById('projectInput');
    if (!input.files || !input.files[0]) {
        alert('⚠️ Lütfen bir görsel seçin!');
        return;
    }

    const file = input.files[0];
    const isVideo = file.type.startsWith('video/');
    const maxSize = isVideo ? 20 * 1024 * 1024 : 5 * 1024 * 1024; // Video 20MB, Image 5MB
    
    if (file.size > maxSize) {
        const maxMB = isVideo ? 20 : 5;
        alert('❌ Dosya çok büyük!\n\nMaksimum: ' + maxMB + 'MB\nDosya: ' + (file.size / (1024 * 1024)).toFixed(2) + 'MB');
        input.value = '';
        return;
    }

    const reader = new FileReader();
    reader.onload = (e) => {
        const newProject = {
            id: 'proj-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9),
            img: e.target.result,
            row: 'top',
            title: '',
            favorite: false,
            tags: [],
            clickCount: 0,
            mediaType: isVideo ? 'video' : 'image'
        };
        projects.push(newProject);
        saveProjects();
        render();
        updateStats();
        updatePreview();
        input.value = '';
        alert('✅ ' + (isVideo ? 'Video' : 'Proje') + ' eklendi!');
    };
    reader.readAsDataURL(file);
}

function deleteProject(id) {
    if (!confirm('🗑️ Bu projeyi silmek istediğinize emin misiniz?')) return;
    
    const project = projects.find(p => p.id === id);
    if (project) {
        // Silinen projeyi kaydet (max 10 proje)
        deletedProjects.unshift(project);
        if (deletedProjects.length > 10) {
            deletedProjects = deletedProjects.slice(0, 10);
        }
        
        // Geri al butonunu göster
        updateUndoButton();
    }
    
    projects = projects.filter(p => p.id !== id);
    saveProjects();
    render();
    updateStats();
    updatePreview();
    alert('✅ Proje silindi! Geri almak için "Geri Al" butonuna basın.');
}

function undoDelete() {
    // Eğer toplu silme varsa onu geri al
    if (clearedZones && clearedZones.length > 0) {
        undoClear();
        return;
    }
    
    // Normal silme geri al
    if (!deletedProjects || deletedProjects.length === 0) {
        alert('⚠️ Geri alınacak proje yok!');
        return;
    }
    
    const restored = deletedProjects.shift();
    if (!restored || !restored.id) {
        alert('❌ Proje verisi bozuk!');
        return;
    }
    
    projects.push(restored);
    
    saveProjects();
    render();
    updateStats();
    updatePreview();
    updateUndoButton();
    
    alert('✅ Proje geri yüklendi!');
}

// YANDEX DISK YEDEKLEME
function yandexDiskBackup() {
    const info = `
☁️ YANDEX DİSK YEDEKLEME

Yandex Disk'e otomatik yedekleme için:

1️⃣ Yandex hesabınızla giriş yapın
2️⃣ OAuth token alın
3️⃣ Token'ı sisteme kaydedin
4️⃣ Otomatik yedekleme başlar

ŞU AN:
- Manuel yedek: "📥 Yedekle" butonu
- Yandex API entegrasyonu için OAuth gerekli

GELECEK GÜNCELLEMEDE:
✅ Otomatik günlük yedek
✅ Bulut senkronizasyonu
✅ Çoklu cihaz desteği

Şimdilik JSON yedeklemesini kullanabilirsiniz!
    `.trim();
    
    alert(info);
    
    // Kullanıcı evet derse JSON yedek yapsın
    if (confirm('JSON yedek dosyası indirmek ister misiniz?')) {
        exportData();
    }
}

function exportData() {
    const data = {
        projects: projects,
        logo: siteLogo,
        exportDate: new Date().toISOString(),
        version: '1.0'
    };
    
    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    const date = new Date().toISOString().split('T')[0];
    a.href = url;
    a.download = `cee-yedek-${date}.json`;
    a.click();
    URL.revokeObjectURL(url);
    
    alert('✅ Yedek dosyası indirildi!\n\nDosya: cee-yedek-' + date + '.json');
}

function importData() {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = '.json';
    
    input.onchange = (e) => {
        const file = e.target.files[0];
        if (!file) return;
        
        const reader = new FileReader();
        reader.onload = (event) => {
            try {
                const data = JSON.parse(event.target.result);
                
                // VALIDATION - Güçlü kontrol
                if (!data || typeof data !== 'object') {
                    throw new Error('Geçersiz dosya formatı');
                }
                
                if (!data.projects || !Array.isArray(data.projects)) {
                    throw new Error('Projeler bulunamadı veya geçersiz format');
                }
                
                // Her projeyi validate et
                const validProjects = data.projects.filter(p => {
                    return p && p.id && p.img && p.row;
                });
                
                if (validProjects.length === 0) {
                    throw new Error('Geçerli proje bulunamadı');
                }
                
                if (validProjects.length < data.projects.length) {
                    const skipped = data.projects.length - validProjects.length;
                    if (!confirm('⚠️ UYARI!\n\n' + skipped + ' bozuk proje atlanacak.\n\nDevam edilsin mi?')) {
                        return;
                    }
                }
                
                if (!confirm('⚠️ UYARI!\n\nYedek dosyasını yüklerseniz mevcut tüm verileriniz silinecek!\n\nGeçerli proje: ' + validProjects.length + '\n\nDevam etmek istediğinize emin misiniz?')) {
                    return;
                }
                
                // Projeleri yükle - eksik alanları tamamla
                projects = validProjects.map(p => ({
                    id: p.id,
                    img: p.img,
                    row: p.row,
                    title: p.title || '',
                    favorite: p.favorite || false,
                    tags: Array.isArray(p.tags) ? p.tags : [],
                    clickCount: p.clickCount || 0,
                    mediaType: p.mediaType || 'image'
                }));
                
                saveProjects();
                
                if (data.logo) {
                    siteLogo = data.logo;
                    try {
                        localStorage.setItem('cee_site_logo', siteLogo);
                    } catch (e) {}
                }
                
                loadLogo();
                render();
                updateStats();
                updatePreview();
                updateUndoButton();
                
                alert('✅ Yedek başarıyla geri yüklendi!\n\n' + 
                      'Projeler: ' + projects.length + '\n' +
                      (data.exportDate ? 'Tarih: ' + new Date(data.exportDate).toLocaleString('tr-TR') : ''));
            } catch (err) {
                alert('❌ HATA!\n\nGeçersiz yedek dosyası!\n\n' + err.message + '\n\nLütfen doğru yedek dosyasını seçin.');
                console.error('Import error:', err);
            }
        };
        reader.readAsText(file);
    };
    
    input.click();
}

// TOPLU SİLME - ÇİFT ONAY + GERİ AL

function clearZone(row) {
    const zoneName = row === 'top' ? 'VİTRİN' : 'ARŞİV';
    const zoneProjects = projects.filter(p => p.row === row);
    
    if (zoneProjects.length === 0) {
        alert('⚠️ ' + zoneName + ' zaten boş!');
        return;
    }
    
    // İLK ONAY
    if (!confirm('🗑️ TOPLU SİLME UYARISI!\n\n' + 
                 zoneName + ' bölümündeki TÜM PROJELERİ silmek istediğinize emin misiniz?\n\n' +
                 'Silinecek: ' + zoneProjects.length + ' proje\n\n' +
                 'Bu işlemi GERİ ALABİLİRSİNİZ.')) {
        return;
    }
    
    // İKİNCİ ONAY - SON ŞANS
    if (!confirm('⚠️ SON ONAY!\n\n' +
                 zoneName + ' bölümündeki ' + zoneProjects.length + ' proje SİLİNECEK!\n\n' +
                 'Devam etmek istediğinize %100 emin misiniz?')) {
        return;
    }
    
    // Silinen zone'u array'e ekle (max 5 zone)
    clearedZones.unshift({
        row: row,
        projects: [...zoneProjects],
        timestamp: Date.now(),
        zoneName: zoneName
    });
    
    if (clearedZones.length > 5) {
        clearedZones = clearedZones.slice(0, 5);
    }
    
    // Projeleri sil
    projects = projects.filter(p => p.row !== row);
    
    saveProjects();
    render();
    updateStats();
    updatePreview();
    updateUndoButton();
    
    alert('✅ ' + zoneName + ' TEMİZLENDİ!\n\n' +
          'Silinen: ' + zoneProjects.length + ' proje\n\n' +
          '↩️ GERİ ALMAK için "Geri Al" butonuna basabilirsiniz!');
}

function updateUndoButton() {
    const btn = document.getElementById('undoBtn');
    if (!btn) return;
    
    // Önce toplu silme kontrolü
    if (clearedZones.length > 0) {
        const latest = clearedZones[0];
        const count = clearedZones.reduce((sum, z) => sum + z.projects.length, 0);
        btn.style.display = 'inline-block';
        btn.textContent = `↩️ ${latest.zoneName}'i Geri Al (${count} proje)`;
        btn.onclick = () => undoClear();
        return;
    }
    
    // Normal silme kontrolü
    if (deletedProjects.length > 0) {
        btn.style.display = 'inline-block';
        btn.textContent = `↩️ Geri Al (${deletedProjects.length})`;
        btn.onclick = () => undoDelete();
    } else {
        btn.style.display = 'none';
    }
}

function undoClear() {
    if (clearedZones.length === 0) {
        alert('⚠️ Geri alınacak toplu silme yok!');
        return;
    }
    
    const latest = clearedZones[0];
    
    if (!confirm('↩️ GERİ AL ONAYI\n\n' +
                 latest.zoneName + ' bölümündeki ' + latest.projects.length + ' projeyi geri yüklemek istiyor musunuz?')) {
        return;
    }
    
    // Projeleri geri yükle
    projects = [...projects, ...latest.projects];
    
    // Array'den çıkar
    clearedZones.shift();
    
    saveProjects();
    render();
    updateStats();
    updatePreview();
    updateUndoButton();
    
    alert('✅ ' + latest.zoneName + ' geri yüklendi!\n\n' + 
          (clearedZones.length > 0 ? 'Kalan geri alınabilir: ' + clearedZones.length : 'Tüm geri almalar tamamlandı.'));
}

// MASAÜSTÜNDEN SÜRÜKLE-BIRAK
function handleFileDrop(e, targetRow) {
    e.preventDefault();
    e.stopPropagation();
    e.currentTarget.classList.remove('drag-over');
    
    // Eğer proje kartı sürükleniyorsa, normal drop işlemi
    if (draggedId) {
        drop(e, targetRow);
        return;
    }
    
    // Eğer dosya sürükleniyorsa
    if (e.dataTransfer.files && e.dataTransfer.files.length > 0) {
        const files = Array.from(e.dataTransfer.files).filter(f => 
            f.type.startsWith('image/') || f.type.startsWith('video/')
        );
        
        if (files.length === 0) {
            alert('⚠️ Sadece resim ve video dosyaları yüklenebilir!');
            return;
        }
        
        processMultipleFiles(files, targetRow);
    }
}

function processMultipleFiles(files, targetRow) {
    // Max 20 dosya limiti
    if (files.length > 20) {
        alert('⚠️ Tek seferde maksimum 20 dosya yükleyebilirsiniz!\n\nSeçili: ' + files.length + ' dosya');
        return;
    }
    
    let processed = 0;
    const totalFiles = files.length;
    let skipped = 0;
    
    alert('📁 ' + totalFiles + ' dosya yükleniyor...');
    
    files.forEach(file => {
        const isVideo = file.type.startsWith('video/');
        const maxSize = isVideo ? 20 * 1024 * 1024 : 5 * 1024 * 1024; // Video 20MB, Image 5MB
        
        if (file.size > maxSize) {
            console.log('⚠️ ' + file.name + ' atlandı (Max: ' + (isVideo ? '20' : '5') + 'MB)');
            skipped++;
            processed++;
            if (processed === totalFiles) finishUpload();
            return;
        }
        
        const reader = new FileReader();
        reader.onload = (e) => {
            const newProject = {
                id: 'proj-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9),
                img: e.target.result,
                row: targetRow,
                title: '',
                favorite: false,
                tags: [],
                clickCount: 0,
                mediaType: isVideo ? 'video' : 'image'
            };
            projects.push(newProject);
            processed++;
            
            if (processed === totalFiles) {
                finishUpload();
            }
        };
        reader.onerror = () => {
            processed++;
            skipped++;
            if (processed === totalFiles) finishUpload();
        };
        reader.readAsDataURL(file);
    });
    
    function finishUpload() {
        saveProjects();
        render();
        updateStats();
        updatePreview();
        const added = totalFiles - skipped;
        let msg = '✅ ' + added + ' proje eklendi!';
        if (skipped > 0) {
            msg += '\n⚠️ ' + skipped + ' dosya atlandı (boyut limiti)';
        }
        alert(msg);
    }
}

// DRAG & DROP - DÜZELTİLMİŞ VERSİYON

function allowDrop(e) {
    if (!e) return;
    e.preventDefault();
    if (e.currentTarget) e.currentTarget.classList.add('drag-over');
}

function dragLeave(e) {
    if (!e || !e.currentTarget) return;
    e.currentTarget.classList.remove('drag-over');
}

function drag(e) {
    if (!e || !e.target) return;
    const card = e.target.closest('.project-card');
    if (!card) return;
    
    draggedId = card.dataset.id;
    if (!draggedId) {
        console.warn('⚠️ Proje ID bulunamadı');
    }
}

function drop(e, targetRow) {
    if (!e) return;
    e.preventDefault();
    if (e.currentTarget) e.currentTarget.classList.remove('drag-over');
    
    if (!draggedId) return;
    
    // Sürüklenen projeyi bul
    const draggedProject = projects.find(p => p.id === draggedId);
    
    if (!draggedProject) {
        draggedId = null;
        return;
    }
    
    const oldRow = draggedProject.row;
    
    // Üzerine bırakılan kart var mı kontrol et
    const dropTarget = e.target.closest('.project-card');
    
    if (oldRow === targetRow && dropTarget && dropTarget.dataset.id !== draggedId) {
        // AYNI ALAN İÇİNDE - YER DEĞİŞTİR (SWAP)
        const targetId = dropTarget.dataset.id;
        const targetProject = projects.find(p => p.id === targetId);
        
        if (targetProject) {
            // İki projenin array'deki indexlerini bul
            const draggedIndex = projects.findIndex(p => p.id === draggedId);
            const targetIndex = projects.findIndex(p => p.id === targetId);
            
            // SWAP - Yer değiştir
            [projects[draggedIndex], projects[targetIndex]] = [projects[targetIndex], projects[draggedIndex]];
            
            // Manuel sıralama moduna geç
            localStorage.setItem('cee_manual_sort', 'true');
        }
    } else if (oldRow !== targetRow) {
        // FARKLI ALANA TAŞI
        draggedProject.row = targetRow;
    }
    
    // Temizle
    draggedId = null;
    
    // Güncelle
    saveProjects();
    render();
    updateStats();
    updatePreview();
}

// PREVIEW
function switchPreview(mode, btn) {
    document.querySelectorAll('.preview-tab').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.preview-mode').forEach(m => m.classList.remove('active'));
    
    btn.classList.add('active');
    document.getElementById(mode + 'Preview').classList.add('active');
}

function updatePreview() {
    updatePreviewZone('mobileTopPreview', 'top');
    updatePreviewZone('mobileBottomPreview', 'bottom');
    updatePreviewZone('desktopTopPreview', 'top');
    updatePreviewZone('desktopBottomPreview', 'bottom');
}

function updatePreviewZone(containerId, row) {
    const container = document.getElementById(containerId);
    const zoneProjects = projects.filter(p => p.row === row);
    
    container.innerHTML = '';
    
    if (zoneProjects.length === 0) {
        container.innerHTML = '<p style="text-align: center; color: #adb5bd; padding: 20px;">Henüz proje yok</p>';
        return;
    }

    zoneProjects.forEach(project => {
        const card = document.createElement('div');
        card.className = 'preview-project-card';
        
        const logoHTML = siteLogo ? `<img src="${siteLogo}" class="preview-logo">` : '';
        card.innerHTML = `
            ${logoHTML}
            <img src="${project.img}" alt="Project">
        `;
        container.appendChild(card);
    });
}

// RENDER
function render() {
    const topZone = document.getElementById('topZone');
    const bottomZone = document.getElementById('bottomZone');
    
    if (!topZone || !bottomZone) {
        console.error('Zones not found');
        return;
    }
    
    // Manuel sıralama kontrolü - DEFAULT: true (Manuel)
    const manualSort = localStorage.getItem('cee_manual_sort') !== 'false'; // NOT: !== 'false' yani default manuel
    
    let topProjects, bottomProjects;
    
    if (manualSort) {
        // MANUEL SIRALAMA: Array sırası korunur (drag&drop ile değiştirilmiş)
        topProjects = projects.filter(p => p.row === 'top');
        bottomProjects = projects.filter(p => p.row === 'bottom');
    } else {
        // OTOMATİK SIRALAMA: En çok tıklanan üstte
        topProjects = projects
            .filter(p => p.row === 'top')
            .sort((a, b) => (b.clickCount || 0) - (a.clickCount || 0));
        
        bottomProjects = projects
            .filter(p => p.row === 'bottom')
            .sort((a, b) => (b.clickCount || 0) - (a.clickCount || 0));
    }

    renderZone(topZone, topProjects);
    renderZone(bottomZone, bottomProjects);
}

function renderZone(zone, zoneProjects) {
    zone.innerHTML = '';
    
    if (zoneProjects.length === 0) {
        zone.innerHTML = '<div class="empty-message">Henüz proje eklenmedi</div>';
    } else {
        zoneProjects.forEach(p => {
            const card = document.createElement('div');
            card.className = 'project-card';
            if (p.favorite) card.classList.add('favorite');
            card.draggable = true;
            card.dataset.id = p.id;
            card.ondragstart = drag;
            
            // SAĞ TIK MENÜ
            card.oncontextmenu = (e) => showContextMenu(e, p.id);
            
            // ÇİFT TIK = TAM EKRAN
            card.ondblclick = () => openFullscreen(p.img, p.id, p.mediaType === 'video');
            
            const logoHTML = siteLogo ? `<img src="${siteLogo}" class="project-logo">` : '';
            
            // Etiketler HTML - XSS korumalı
            let tagsHTML = '';
            if (p.tags && p.tags.length > 0) {
                tagsHTML = '<div class="project-tags">';
                p.tags.forEach(tag => {
                    // XSS koruması: tehlikeli karakterleri temizle
                    const safeTag = String(tag).replace(/[<>"']/g, '').toLowerCase();
                    tagsHTML += `<span class="tag ${safeTag}">${safeTag}</span>`;
                });
                tagsHTML += '</div>';
            }
            
            // Click counter
            const clickCount = p.clickCount || 0;
            const clickCountHTML = `<div class="click-counter"><span class="icon">👁️</span><span>${clickCount}</span></div>`;
            
            // Media HTML - Video veya Image
            const isVideo = p.mediaType === 'video';
            let mediaHTML = '';
            if (isVideo) {
                mediaHTML = `
                    <video style="width: 100%; height: 100%; object-fit: cover; cursor: pointer;" 
                           muted loop playsinline>
                        <source src="${p.img}" type="video/mp4">
                    </video>
                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); 
                                font-size: 48px; opacity: 0.8; pointer-events: none;">▶️</div>
                `;
            } else {
                mediaHTML = `<img src="${p.img}" alt="Project" style="cursor: zoom-in;">`;
            }
            
            card.innerHTML = `
                ${logoHTML}
                ${mediaHTML}
                ${tagsHTML}
                ${clickCountHTML}
            `;
            
            // Title'ı güvenli ekle - XSS koruması
            if (p.title) {
                const titleDiv = document.createElement('div');
                titleDiv.className = 'project-title';
                titleDiv.textContent = p.title; // textContent = XSS safe
                card.appendChild(titleDiv);
            }
            
            // Image/Video'ya tıklama eventi ekle (projectId ile)
            const projectMedia = card.querySelector('img[alt="Project"], video');
            if (projectMedia) {
                if (isVideo) {
                    // Video hover = play, leave = pause
                    projectMedia.onmouseenter = () => projectMedia.play();
                    projectMedia.onmouseleave = () => {
                        projectMedia.pause();
                        projectMedia.currentTime = 0;
                    };
                }
                projectMedia.onclick = () => openFullscreen(p.img, p.id, isVideo);
            }
            
            // Favorite button
            const favBtn = document.createElement('button');
            favBtn.className = 'favorite-btn';
            favBtn.textContent = p.favorite ? '⭐' : '☆';
            favBtn.title = p.favorite ? 'Favorilerden çıkar' : 'Favorilere ekle';
            favBtn.onclick = (e) => {
                e.stopPropagation();
                toggleFavorite(p.id);
            };
            card.appendChild(favBtn);
            
            // Edit title button
            const editBtn = document.createElement('button');
            editBtn.className = 'edit-title-btn';
            editBtn.textContent = '✏️ Başlık';
            editBtn.onclick = (e) => {
                e.stopPropagation();
                editProjectTitle(p.id);
            };
            card.appendChild(editBtn);
            
            // Delete button
            const deleteBtn = document.createElement('button');
            deleteBtn.className = 'delete-btn';
            deleteBtn.textContent = 'SİL';
            deleteBtn.onclick = () => deleteProject(p.id);
            card.appendChild(deleteBtn);
            
            zone.appendChild(card);
        });
    }
}

function updateStats() {
    const topCount = projects.filter(p => p.row === 'top').length;
    const bottomCount = projects.filter(p => p.row === 'bottom').length;
    const favoriteCount = projects.filter(p => p.favorite).length;
    
    // Toplam dosya boyutu hesapla
    let totalBytes = 0;
    projects.forEach(p => {
        if (p.img) {
            // Base64 boyutunu hesapla (yaklaşık)
            const base64Length = p.img.length - (p.img.indexOf(',') + 1);
            totalBytes += (base64Length * 3) / 4; // Base64'ten byte'a çevir
        }
    });
    const totalMB = (totalBytes / (1024 * 1024)).toFixed(2);
    
    // Son eklenen projeyi bul (en yüksek timestamp)
    let lastAddedText = '-';
    if (projects.length > 0) {
        // ID'den timestamp çıkar: 'proj-1736012345678-abc'
        const timestamps = projects.map(p => {
            const match = p.id.match(/proj-(\d+)-/);
            return match ? parseInt(match[1]) : 0;
        });
        const latestTimestamp = Math.max(...timestamps);
        
        if (latestTimestamp > 0) {
            const now = Date.now();
            const diff = now - latestTimestamp;
            const minutes = Math.floor(diff / 60000);
            const hours = Math.floor(diff / 3600000);
            const days = Math.floor(diff / 86400000);
            
            if (minutes < 1) {
                lastAddedText = 'Az önce';
            } else if (minutes < 60) {
                lastAddedText = minutes + ' dk önce';
            } else if (hours < 24) {
                lastAddedText = hours + ' saat önce';
            } else {
                lastAddedText = days + ' gün önce';
            }
        }
    }
    
    // Toplam tıklanma sayısı
    const totalClicks = projects.reduce((sum, p) => sum + (p.clickCount || 0), 0);
    
    // En çok tıklanan proje
    let mostClickedText = '-';
    if (projects.length > 0) {
        const sorted = [...projects].sort((a, b) => (b.clickCount || 0) - (a.clickCount || 0));
        if (sorted[0] && sorted[0].clickCount > 0) {
            const topProject = sorted[0];
            const displayName = topProject.title || 'Başlıksız';
            mostClickedText = displayName.substring(0, 12) + (displayName.length > 12 ? '...' : '');
        }
    }
    
    // DOM güncelle - null check ile
    const topCountEl = document.getElementById('topCount');
    const bottomCountEl = document.getElementById('bottomCount');
    const totalProjectsEl = document.getElementById('totalProjects');
    const showcaseProjectsEl = document.getElementById('showcaseProjects');
    const archiveProjectsEl = document.getElementById('archiveProjects');
    const favoriteProjectsEl = document.getElementById('favoriteProjects');
    const totalSizeEl = document.getElementById('totalSize');
    const totalClicksEl = document.getElementById('totalClicks');
    const mostClickedEl = document.getElementById('mostClicked');
    const lastAddedEl = document.getElementById('lastAdded');
    
    if (topCountEl) topCountEl.textContent = topCount + ' Proje';
    if (bottomCountEl) bottomCountEl.textContent = bottomCount + ' Proje';
    if (totalProjectsEl) totalProjectsEl.textContent = projects.length;
    if (showcaseProjectsEl) showcaseProjectsEl.textContent = topCount;
    if (archiveProjectsEl) archiveProjectsEl.textContent = bottomCount;
    if (favoriteProjectsEl) favoriteProjectsEl.textContent = favoriteCount;
    if (totalSizeEl) totalSizeEl.textContent = totalMB + ' MB';
    if (totalClicksEl) totalClicksEl.textContent = totalClicks;
    if (mostClickedEl) mostClickedEl.textContent = mostClickedText;
    if (lastAddedEl) lastAddedEl.textContent = lastAddedText;
}

function saveProjects() {
    try {
        const data = JSON.stringify(projects);
        const sizeInMB = (new Blob([data]).size / (1024 * 1024)).toFixed(2);
        
        // LocalStorage limit kontrolü (max 5MB)
        if (sizeInMB > 4.5) {
            alert('⚠️ UYARI!\n\nDepolama alanı dolmak üzere!\n\nBoyut: ' + sizeInMB + ' MB / 5 MB\n\nÖneri:\n- Eski projeleri silin\n- Yedek alıp temizleyin\n- Video yerine resim kullanın');
        }
        
        localStorage.setItem('cee_projects', data);
    } catch (e) {
        if (e.name === 'QuotaExceededError') {
            alert('❌ DEPOLAMA DOLU!\n\nLocalStorage limiti aşıldı!\n\nÇözüm:\n1. Eski projeleri silin\n2. Yedek alın\n3. Tarayıcı verilerini temizleyin');
        }
        console.log('LocalStorage error:', e);
    }
}

// DARK MODE
function toggleDarkMode() {
    document.body.classList.toggle('dark-mode');
    const isDark = document.body.classList.contains('dark-mode');
    
    const btn = document.getElementById('darkModeBtn');
    if (btn) {
        btn.textContent = isDark ? '☀️ Light Mode' : '🌙 Dark Mode';
    }
    
    // Save preference
    try {
        localStorage.setItem('cee_dark_mode', isDark);
    } catch (e) {}
}

// Load dark mode preference
function loadDarkMode() {
    try {
        const isDark = localStorage.getItem('cee_dark_mode') === 'true';
        if (isDark) {
            document.body.classList.add('dark-mode');
            const btn = document.getElementById('darkModeBtn');
            if (btn) btn.textContent = '☀️ Light Mode';
        }
    } catch (e) {}
}

// SIRALAMA MODU
function toggleSortMode() {
    const currentMode = localStorage.getItem('cee_manual_sort') !== 'false'; // DEFAULT: Manuel
    const newMode = !currentMode;
    
    try {
        localStorage.setItem('cee_manual_sort', newMode ? 'true' : 'false');
    } catch (e) {}
    
    updateSortModeButton();
    render();
    
    const modeText = newMode ? 'Manuel' : 'Otomatik (Tıklanma)';
    alert('🔢 Sıralama Modu: ' + modeText + '\n\n' + 
          (newMode ? 
           'Manuel mod: Sürükle-bırak ile sıralama yapabilirsiniz.' : 
           'Otomatik mod: En çok tıklanan projeler üstte görünür.'));
}

function updateSortModeButton() {
    const btn = document.getElementById('sortModeBtn');
    if (!btn) return;
    
    const isManual = localStorage.getItem('cee_manual_sort') !== 'false'; // DEFAULT: Manuel
    btn.textContent = isManual ? '✋ Manuel Sıralama' : '🔢 Otomatik Sıralama';
    btn.title = isManual ? 
        'Şu an: Manuel sıralama (sürükle-bırak)' : 
        'Şu an: Otomatik sıralama (en çok tıklanan üstte)';
}

// FAVORITE
function toggleFavorite(id) {
    const project = projects.find(p => p.id === id);
    if (project) {
        project.favorite = !project.favorite;
        saveProjects();
        render();
        
        const star = project.favorite ? '⭐' : '☆';
        console.log(star + ' Favori güncellendi');
    }
}

// TITLE EDIT
function editProjectTitle(id) {
    if (!id) return;
    const project = projects.find(p => p.id === id);
    if (!project) {
        alert('❌ Proje bulunamadı!');
        return;
    }
    
    const newTitle = prompt('Proje başlığı girin:\n(Sadece admin panelinde görünür)\n(Max 50 karakter)', project.title || '');
    
    if (newTitle !== null) {
        // Sanitize - tehlikeli karakterleri temizle ve max 50 karakter
        const sanitized = newTitle.trim().replace(/[<>"']/g, '').substring(0, 50);
        project.title = sanitized;
        saveProjects();
        render();
        updateStats();
    }
}

// FULLSCREEN
function openFullscreen(mediaSrc, projectId, isVideo) {
    const modal = document.getElementById('fullscreenModal');
    const img = document.getElementById('fullscreenImg');
    const logo = document.getElementById('fullscreenLogo');
    
    if (modal && img) {
        if (isVideo) {
            // Video için video tag oluştur
            img.style.display = 'none';
            let video = document.getElementById('fullscreenVideo');
            if (!video) {
                video = document.createElement('video');
                video.id = 'fullscreenVideo';
                video.className = 'main-img';
                video.controls = true;
                video.autoplay = true;
                video.style.maxWidth = '100%';
                video.style.maxHeight = '90vh';
                document.querySelector('.fullscreen-content').appendChild(video);
            }
            video.src = mediaSrc;
            video.style.display = 'block';
        } else {
            // Image için
            const video = document.getElementById('fullscreenVideo');
            if (video) video.style.display = 'none';
            img.src = mediaSrc;
            img.style.display = 'block';
        }
        
        // Logo varsa göster
        if (siteLogo && logo) {
            logo.src = siteLogo;
            logo.style.display = 'block';
        } else if (logo) {
            logo.style.display = 'none';
        }
        
        modal.classList.add('show');
        
        // TIKLANMA SAYISINI ARTIR
        if (projectId) {
            const project = projects.find(p => p.id === projectId);
            if (project) {
                if (!project.clickCount) project.clickCount = 0;
                project.clickCount++;
                saveProjects();
                render();
                console.log('👁️ Tıklanma: ' + project.clickCount);
            }
        }
    }
}

function closeFullscreen() {
    const modal = document.getElementById('fullscreenModal');
    if (modal) {
        modal.classList.remove('show');
        
        // Video varsa durdur ve temizle (memory leak önleme)
        const video = document.getElementById('fullscreenVideo');
        if (video) {
            video.pause();
            video.src = '';
            video.load();
        }
    }
}

// Escape key to close
document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
        closeFullscreen();
        closeContextMenu();
    }
});

// KLAVYE KISAYOLLARI
document.addEventListener('keydown', (e) => {
    // ESC zaten yukarıda
    if (e.key === 'Escape') return;
    
    // CTRL/CMD kombinasyonları
    if (e.ctrlKey || e.metaKey) {
        switch(e.key.toLowerCase()) {
            case 's': // CTRL + S = Yedekle
                e.preventDefault();
                exportData();
                break;
            case 'e': // CTRL + E = PDF Export
                e.preventDefault();
                exportToPDF();
                break;
            case 'd': // CTRL + D = Dark Mode
                e.preventDefault();
                toggleDarkMode();
                break;
            case 'z': // CTRL + Z = Geri Al
                e.preventDefault();
                if (clearedZones.length > 0 || deletedProjects.length > 0) {
                    undoDelete();
                }
                break;
            case 'n': // CTRL + N = Yeni Proje
                e.preventDefault();
                document.getElementById('projectInput').click();
                break;
            case 'l': // CTRL + L = Logo Değiştir
                e.preventDefault();
                document.getElementById('logoInput').click();
                break;
        }
    }
    
    // DELETE tuşu - son tıklanan projeyi sil (eğer varsa)
    if (e.key === 'Delete' && contextMenuProjectId) {
        if (confirm('Projeyi silmek istediğinize emin misiniz?')) {
            deleteProject(contextMenuProjectId);
            contextMenuProjectId = null;
        }
    }
});

// Klavye kısayolları yardım paneli
function showKeyboardHelp() {
    const helpText = `
⌨️ KLAVYE KISAYOLLARI:

CTRL + S  →  Yedekle
CTRL + E  →  PDF Katalog
CTRL + D  →  Dark/Light Mode
CTRL + Z  →  Geri Al
CTRL + N  →  Yeni Proje
CTRL + L  →  Logo Değiştir
ESC       →  Kapat
DELETE    →  Seçili Projeyi Sil
    `.trim();
    
    alert(helpText);
}


// CONTEXT MENU (SAĞ TIK)
let contextMenuProjectId = null;

function showContextMenu(e, projectId) {
    if (!e) return;
    e.preventDefault();
    e.stopPropagation();
    contextMenuProjectId = projectId;
    
    const menu = document.getElementById('contextMenu');
    if (!menu) return;
    
    // Menüyü göster (pozisyon için boyutları almak için)
    menu.classList.add('show');
    
    // FIXED pozisyon için sadece clientX/Y kullan (scroll otomatik)
    let x = e.clientX || 0;
    let y = e.clientY || 0;
    
    // Ekran boyutları
    const windowWidth = window.innerWidth || document.documentElement.clientWidth;
    const windowHeight = window.innerHeight || document.documentElement.clientHeight;
    const menuWidth = menu.offsetWidth || 180;
    const menuHeight = menu.offsetHeight || 300;
    
    // Sağ taşma kontrolü
    if (x + menuWidth > windowWidth) {
        x = x - menuWidth;
    }
    
    // Alt taşma kontrolü
    if (y + menuHeight > windowHeight) {
        y = y - menuHeight;
    }
    
    // Minimum pozisyon (ekranın dışına çıkmasın)
    x = Math.max(5, x);
    y = Math.max(5, y);
    
    menu.style.left = x + 'px';
    menu.style.top = y + 'px';
}

function closeContextMenu() {
    const menu = document.getElementById('contextMenu');
    if (menu) {
        menu.classList.remove('show');
    }
    contextMenuProjectId = null;
}

function contextAction(action) {
    if (!contextMenuProjectId) return;
    
    const project = projects.find(p => p.id === contextMenuProjectId);
    if (!project) return;
    
    switch(action) {
        case 'fullscreen':
            openFullscreen(project.img, project.id, project.mediaType === 'video');
            break;
        case 'favorite':
            toggleFavorite(contextMenuProjectId);
            break;
        case 'edit':
            editProjectTitle(contextMenuProjectId);
            break;
        case 'tag':
            addTag(contextMenuProjectId);
            break;
        case 'moveTop':
            project.row = 'top';
            saveProjects();
            render();
            updateStats();
            updatePreview();
            break;
        case 'moveBottom':
            project.row = 'bottom';
            saveProjects();
            render();
            updateStats();
            updatePreview();
            break;
        case 'delete':
            deleteProject(contextMenuProjectId);
            break;
    }
    
    closeContextMenu();
}

// Click anywhere to close menu
document.addEventListener('click', closeContextMenu);

// ETİKET SİSTEMİ
function addTag(projectId) {
    if (!projectId) return;
    const project = projects.find(p => p.id === projectId);
    if (!project) {
        alert('❌ Proje bulunamadı!');
        return;
    }
    
    if (!project.tags) project.tags = [];
    
    // Max 5 etiket kontrolü
    if (project.tags.length >= 5) {
        alert('⚠️ Maksimum 5 etiket ekleyebilirsiniz!');
        return;
    }
    
    const tagOptions = ['Villa', 'Apartman', 'Ofis', 'Ticari', 'Konut', 'Diğer'];
    let tagList = tagOptions.map((t, i) => `${i+1}. ${t}`).join('\n');
    
    const choice = prompt(`Etiket seçin:\n\n${tagList}\n\nNumara girin (1-6):`);
    
    if (!choice) return;
    
    const choiceNum = parseInt(choice);
    if (isNaN(choiceNum) || choiceNum < 1 || choiceNum > 6) {
        alert('❌ Geçersiz seçim! 1-6 arası bir sayı girin.');
        return;
    }
    
    const tag = tagOptions[choiceNum - 1].toLowerCase();
    
    if (project.tags.includes(tag)) {
        alert('⚠️ Bu etiket zaten ekli!');
        return;
    }
    
    project.tags.push(tag);
    saveProjects();
    render();
    updateStats();
}

// PDF EXPORT - PROFESYONEL KATALOG
async function exportToPDF() {
    if (projects.length === 0) {
        alert('⚠️ Henüz proje yok! Önce proje ekleyin.');
        return;
    }
    
    alert('📄 PDF oluşturuluyor...\n\nBu birkaç saniye sürebilir.');
    
    // jsPDF kütüphanesini dinamik yükle
    const script = document.createElement('script');
    script.src = 'https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js';
    script.onload = () => generatePDF();
    script.onerror = () => alert('❌ PDF oluşturulamadı! İnternet bağlantınızı kontrol edin.');
    document.head.appendChild(script);
}

function generatePDF() {
    try {
        if (!window.jspdf) {
            alert('❌ PDF kütüphanesi yüklenemedi!\n\nİnternet bağlantınızı kontrol edin.');
            return;
        }
        
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF('p', 'mm', 'a4');
        
        // FONT FIX - Türkçe karakterler için
        doc.setLanguage("tr");
        
        const pageWidth = 210;
        const pageHeight = 297;
        const margin = 20;
        let yPosition = margin;
        
        // KAPAK SAYFASI
        doc.setFontSize(32);
        doc.setFont("helvetica", 'bold');
        doc.text('CEE', pageWidth / 2, 80, { align: 'center' });
        
        doc.setFontSize(24);
        doc.text('PROJE KATALOGU', pageWidth / 2, 100, { align: 'center' });
        
        doc.setFontSize(12);
        doc.setFont("helvetica", 'normal');
        const today = new Date().toLocaleDateString('tr-TR');
        doc.text(today, pageWidth / 2, 120, { align: 'center' });
        
        doc.setFontSize(10);
        doc.text('Toplam ' + (projects.length || 0) + ' Proje', pageWidth / 2, 140, { align: 'center' });
        
        // Logo varsa ekle
        if (siteLogo) {
            try {
                doc.addImage(siteLogo, 'PNG', pageWidth / 2 - 25, 30, 50, 50);
            } catch (e) {
                console.log('Logo eklenemedi:', e);
            }
        }
        
        doc.addPage();
        yPosition = margin;
        
        // VİTRİN PROJELERİ
        const vitrinProjects = (projects || []).filter(p => p && p.row === 'top');
        const arsivProjects = (projects || []).filter(p => p && p.row === 'bottom');
    
    if (vitrinProjects.length > 0) {
        doc.setFontSize(18);
        doc.setFont("helvetica", 'bold');
        doc.text('VITRIN PROJELERI', margin, yPosition);
        yPosition += 10;
        
        doc.setFontSize(10);
        doc.setFont("helvetica", 'normal');
        doc.text(vitrinProjects.length + ' Proje', margin, yPosition);
        yPosition += 10;
        
        vitrinProjects.forEach((project, index) => {
            if (yPosition > pageHeight - 100) {
                doc.addPage();
                yPosition = margin;
            }
            
            // Proje resmi
            try {
                const imgHeight = 80;
                doc.addImage(project.img, 'JPEG', margin, yPosition, 170, imgHeight);
                
                // Logo ekle (küçük)
                if (siteLogo) {
                    doc.addImage(siteLogo, 'PNG', margin + 5, yPosition + 5, 15, 15);
                }
                
                yPosition += imgHeight + 5;
            } catch (e) {}
            
            // Başlık
            if (project.title) {
                doc.setFontSize(12);
                doc.setFont("helvetica", 'bold');
                doc.text(project.title, margin, yPosition);
                yPosition += 6;
            }
            
            // Etiketler
            if (project.tags && project.tags.length > 0) {
                doc.setFontSize(9);
                doc.setFont("helvetica", 'normal');
                const tagsText = 'Etiket: ' + project.tags.join(', ').toUpperCase();
                doc.text(tagsText, margin, yPosition);
                yPosition += 6;
            }
            
            // Favori
            if (project.favorite) {
                doc.text('* Favori', margin, yPosition);
                yPosition += 6;
            }
            
            yPosition += 10;
        });
    }
    
    // ARŞİV PROJELERİ
    if (arsivProjects.length > 0) {
        doc.addPage();
        yPosition = margin;
        
        doc.setFontSize(18);
        doc.setFont("helvetica", 'bold');
        doc.text('ARSIV PROJELERI', margin, yPosition);
        yPosition += 10;
        
        doc.setFontSize(10);
        doc.setFont("helvetica", 'normal');
        doc.text(arsivProjects.length + ' Proje', margin, yPosition);
        yPosition += 10;
        
        arsivProjects.forEach((project, index) => {
            if (yPosition > pageHeight - 100) {
                doc.addPage();
                yPosition = margin;
            }
            
            try {
                const imgHeight = 80;
                doc.addImage(project.img, 'JPEG', margin, yPosition, 170, imgHeight);
                
                if (siteLogo) {
                    doc.addImage(siteLogo, 'PNG', margin + 5, yPosition + 5, 15, 15);
                }
                
                yPosition += imgHeight + 5;
            } catch (e) {}
            
            if (project.title) {
                doc.setFontSize(12);
                doc.setFont("helvetica", 'bold');
                doc.text(project.title, margin, yPosition);
                yPosition += 6;
            }
            
            if (project.tags && project.tags.length > 0) {
                doc.setFontSize(9);
                doc.setFont("helvetica", 'normal');
                const tagsText = 'Etiket: ' + project.tags.join(', ').toUpperCase();
                doc.text(tagsText, margin, yPosition);
                yPosition += 6;
            }
            
            yPosition += 10;
        });
    }
    
    // FOOTER - Her sayfaya
    const pageCount = doc.internal.getNumberOfPages();
    for (let i = 1; i <= pageCount; i++) {
        doc.setPage(i);
        doc.setFontSize(8);
        doc.setFont("helvetica", 'normal');
        doc.text('Sayfa ' + i + ' / ' + pageCount, pageWidth / 2, pageHeight - 10, { align: 'center' });
        doc.text('CEE - www.cee.com', pageWidth / 2, pageHeight - 6, { align: 'center' });
    }
    
    // KAYDET
    const filename = 'cee-katalog-' + new Date().toISOString().split('T')[0] + '.pdf';
    doc.save(filename);
    
    alert('PDF olusturuldu!\n\n' + filename + '\n\nIndirildi!');
    
    } catch (error) {
        console.error('PDF oluşturma hatası:', error);
        alert('❌ PDF oluşturulamadı!\n\n' + error.message + '\n\nLütfen tekrar deneyin.');
    }
}

// ===============================
// FILE CONVERTER FUNCTIONS
// ===============================

// Helper: Show status message
function showConverterStatus(id, message, type = 'processing', progress = 0) {
    const status = document.getElementById(id);
    const messageEl = document.getElementById(id.replace('Status', 'Message'));
    const progressBar = document.getElementById(id.replace('Status', 'Progress'));
    
    if (status) {
        status.className = `converter-status show ${type}`;
        if (messageEl) messageEl.textContent = message;
        if (progressBar) progressBar.style.width = progress + '%';
    }
}

// Helper: Download file
function downloadFile(blob, filename) {
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
}

// 1. IMAGE CONVERTER
async function convertImage() {
    const input = document.getElementById('imgInput');
    const from = document.getElementById('imgFrom').value;
    const to = document.getElementById('imgTo').value;
    
    if (!input.files.length) {
        showConverterStatus('imgStatus', '❌ Lütfen dosya seçin!', 'error');
        return;
    }
    
    showConverterStatus('imgStatus', '🔄 Dönüştürülüyor...', 'processing', 0);
    
    try {
        const files = Array.from(input.files);
        let processed = 0;
        
        for (const file of files) {
            const img = new Image();
            const reader = new FileReader();
            
            await new Promise((resolve, reject) => {
                reader.onload = (e) => {
                    img.onload = async () => {
                        try {
                            const canvas = document.createElement('canvas');
                            canvas.width = img.width;
                            canvas.height = img.height;
                            const ctx = canvas.getContext('2d');
                            ctx.drawImage(img, 0, 0);
                            
                            // Convert based on target format
                            if (to === 'pdf') {
                                // For PDF, we'll use jsPDF if available
                                alert('PDF dönüşümü için jsPDF kütüphanesi gerekli. Şimdilik PNG/JPEG/WEBP destekleniyor.');
                                reject('PDF not supported yet');
                            } else {
                                const mimeType = to === 'png' ? 'image/png' : 
                                               to === 'jpeg' ? 'image/jpeg' : 
                                               to === 'webp' ? 'image/webp' : 'image/png';
                                const quality = to === 'jpeg' ? 0.9 : 1.0;
                                
                                canvas.toBlob((blob) => {
                                    const filename = file.name.replace(/\.[^/.]+$/, '') + '.' + to;
                                    downloadFile(blob, filename);
                                    resolve();
                                }, mimeType, quality);
                            }
                        } catch (err) {
                            reject(err);
                        }
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
            });
            
            processed++;
            const progress = (processed / files.length) * 100;
            showConverterStatus('imgStatus', `✅ ${processed}/${files.length} dosya dönüştürüldü`, 'success', progress);
        }
        
        setTimeout(() => {
            showConverterStatus('imgStatus', `✅ ${processed} dosya başarıyla dönüştürüldü!`, 'success', 100);
        }, 500);
        
    } catch (error) {
        console.error('Image conversion error:', error);
        showConverterStatus('imgStatus', '❌ Dönüştürme hatası: ' + error.message, 'error');
    }
}

// ========================================
// ========================================
// MİNİMAL DOSYA DÖNÜŞTÜRÜCÜ
// ========================================

let miniFile = null;

// Format seçenekleri - Format kodu doğrudan
const miniFormats = {
    'dwg': [
        {name: '📄 PDF', value: 'pdf'},
        {name: '🖼️ JPEG', value: 'jpeg'},
        {name: '🎨 PNG', value: 'png'},
        {name: '🌐 SVG', value: 'svg'},
        {name: '📐 DXF', value: 'dxf'},
        {name: '📋 DWF', value: 'dwf'}
    ],
    'dxf': [
        {name: '📐 DWG', value: 'dwg'},
        {name: '📄 PDF', value: 'pdf'},
        {name: '🖼️ JPEG', value: 'jpeg'},
        {name: '🎨 PNG', value: 'png'}
    ],
    'pdf': [
        {name: '🖼️ JPEG', value: 'jpeg'},
        {name: '🎨 PNG', value: 'png'},
        {name: '📝 WORD', value: 'docx'},
        {name: '📊 EXCEL', value: 'xlsx'},
        {name: '📐 DWG', value: 'dwg'}
    ],
    'jpeg': [
        {name: '🎨 PNG', value: 'png'},
        {name: '📄 PDF', value: 'pdf'},
        {name: '🌐 WEBP', value: 'webp'},
        {name: '⚫ GIF', value: 'gif'},
        {name: '🖼️ BMP', value: 'bmp'}
    ],
    'jpg': [
        {name: '🎨 PNG', value: 'png'},
        {name: '📄 PDF', value: 'pdf'},
        {name: '🌐 WEBP', value: 'webp'},
        {name: '⚫ GIF', value: 'gif'},
        {name: '🖼️ BMP', value: 'bmp'}
    ],
    'png': [
        {name: '🖼️ JPEG', value: 'jpeg'},
        {name: '📄 PDF', value: 'pdf'},
        {name: '🌐 WEBP', value: 'webp'},
        {name: '⚫ GIF', value: 'gif'},
        {name: '🖼️ BMP', value: 'bmp'}
    ],
    'webp': [
        {name: '🖼️ JPEG', value: 'jpeg'},
        {name: '🎨 PNG', value: 'png'},
        {name: '📄 PDF', value: 'pdf'},
        {name: '⚫ GIF', value: 'gif'}
    ],
    'bmp': [
        {name: '🖼️ JPEG', value: 'jpeg'},
        {name: '🎨 PNG', value: 'png'},
        {name: '🌐 WEBP', value: 'webp'},
        {name: '📄 PDF', value: 'pdf'}
    ],
    'gif': [
        {name: '🖼️ JPEG', value: 'jpeg'},
        {name: '🎨 PNG', value: 'png'},
        {name: '📄 PDF', value: 'pdf'}
    ],
    'docx': [
        {name: '📄 PDF', value: 'pdf'},
        {name: '🌐 HTML', value: 'html'},
        {name: '📋 TXT', value: 'txt'}
    ],
    'xlsx': [
        {name: '📄 PDF', value: 'pdf'},
        {name: '📊 CSV', value: 'csv'}
    ],
    'pptx': [
        {name: '📄 PDF', value: 'pdf'},
        {name: '🖼️ JPEG', value: 'jpeg'}
    ],
    'mp4': [
        {name: '🎵 MP3', value: 'mp3'},
        {name: '🎬 GIF', value: 'gif'}
    ]
};

// Kompakt menü toggle
function toggleCompactMenu() {
    const menu = document.getElementById('compactMenu');
    menu.classList.toggle('show');
}

function closeCompactMenu() {
    document.getElementById('compactMenu').classList.remove('show');
}

// Dışarı tıklanınca kapat
document.addEventListener('click', function(e) {
    const menuWrapper = document.querySelector('.compact-menu-wrapper');
    if (menuWrapper && !menuWrapper.contains(e.target)) {
        closeCompactMenu();
    }
});

// Mini converter bar handler
function handleMiniConverter(input) {
    const file = input.files[0];
    if (!file) return;
    
    miniFile = file;
    const ext = file.name.split('.').pop().toLowerCase();
    const formats = miniFormats[ext] || [];
    
    const bar = document.getElementById('miniConverterBar');
    const select = document.getElementById('miniConverterFormat');
    const btn = document.getElementById('miniConvertBtn');
    const status = document.getElementById('miniConverterStatus');
    
    if (formats.length === 0) {
        alert('❌ Bu dosya tipi desteklenmiyor: ' + ext.toUpperCase());
        input.value = '';
        return;
    }
    
    // Dropdown'ı doldur - YENİ FORMAT
    select.innerHTML = '<option value="">Format Seçin →</option>';
    formats.forEach(f => {
        const opt = document.createElement('option');
        opt.value = f.value;  // Doğrudan value
        opt.textContent = f.name;  // Emoji + isim
        select.appendChild(opt);
    });
    
    // Bar'ı göster
    bar.style.display = 'block';
    
    // Format seçilince butonu göster
    select.onchange = function() {
        btn.style.display = this.value ? 'inline-block' : 'none';
    };
    
    // Durum mesajı
    status.innerHTML = `📁 ${file.name} <span style="opacity:0.8">(${(file.size/1024/1024).toFixed(2)} MB)</span>`;
    
    // Sayfayı kaydır
    bar.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
}

function closeMiniConverter() {
    document.getElementById('miniConverterBar').style.display = 'none';
    document.getElementById('miniConverterFile').value = '';
    document.getElementById('miniConverterFormat').value = '';
    document.getElementById('miniConvertBtn').style.display = 'none';
    miniFile = null;
}

async function executeMiniConvert() {
    if (!miniFile) {
        alert('❌ Dosya seçilmedi!');
        return;
    }
    
    const targetFormat = document.getElementById('miniConverterFormat').value;
    if (!targetFormat) {
        alert('⚠️ Lütfen hedef format seçin');
        return;
    }
    
    const status = document.getElementById('miniConverterStatus');
    const sourceExt = miniFile.name.split('.').pop().toLowerCase();
    
    // DEBUG
    console.log('=== DÖNÜŞÜM BAŞLADI ===');
    console.log('Kaynak:', sourceExt);
    console.log('Hedef:', targetFormat);
    
    status.innerHTML = '⏳ Dönüştürülüyor...';
    
    // Sadece çalışan resim formatları
    const workingFormats = ['jpeg', 'jpg', 'png', 'webp', 'gif', 'bmp'];
    
    console.log('Working formats:', workingFormats);
    console.log('Source in list?', workingFormats.includes(sourceExt));
    console.log('Target in list?', workingFormats.includes(targetFormat));
    
    try {
        // 1. Resim → Resim (gerçekten çalışıyor!)
        if (workingFormats.includes(sourceExt) && workingFormats.includes(targetFormat)) {
            console.log('✅ Resim→Resim dönüşümü başlatılıyor...');
            await convertMiniImage(miniFile, targetFormat);
            status.innerHTML = '✅ <b>Başarılı!</b> ' + targetFormat.toUpperCase() + ' dosyası indirildi!';
            setTimeout(() => closeMiniConverter(), 4000);
            return; // ÖNEMLİ
        }
        
        // 2. Resim → PDF
        if (workingFormats.includes(sourceExt) && targetFormat === 'pdf') {
            console.log('✅ Resim→PDF dönüşümü başlatılıyor...');
            await convertImageToPDF(miniFile);
            status.innerHTML = '✅ <b>Başarılı!</b> JPG dosyası indirildi (Gerçek PDF için kütüphane gerekir)';
            setTimeout(() => closeMiniConverter(), 5000);
            return;
        }
        
        // 3. Diğer tüm dönüşümler - Harici araç önerileri
        console.log('ℹ️ Harici araç önerisi gösteriliyor...');
        status.innerHTML = '🔧 <b>Bu dönüşüm tarayıcıda yapılamaz</b><br><br>' +
                          '<div style="background:rgba(255,255,255,0.1); padding:12px; border-radius:6px; margin-top:10px;">' +
                          getMiniToolInfo(sourceExt, targetFormat) +
                          '</div>';
        
    } catch (err) {
        console.error('❌ Hata:', err);
        status.innerHTML = '❌ <b>Hata:</b> ' + err.message;
    }
}

// Resim → PDF dönüştürücü
async function convertImageToPDF(file) {
    return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = e => {
            const img = new Image();
            img.onload = () => {
                try {
                    // A4 boyutu (595 x 842 pt)
                    const maxWidth = 595;
                    const maxHeight = 842;
                    
                    let width = img.width;
                    let height = img.height;
                    
                    // Oranı koru
                    if (width > maxWidth) {
                        height = (height / width) * maxWidth;
                        width = maxWidth;
                    }
                    if (height > maxHeight) {
                        width = (width / height) * maxHeight;
                        height = maxHeight;
                    }
                    
                    const canvas = document.createElement('canvas');
                    canvas.width = width;
                    canvas.height = height;
                    const ctx = canvas.getContext('2d');
                    
                    // Beyaz arka plan
                    ctx.fillStyle = 'white';
                    ctx.fillRect(0, 0, width, height);
                    ctx.drawImage(img, 0, 0, width, height);
                    
                    // PDF olarak indir (basit: tek sayfa, resim olarak)
                    canvas.toBlob(blob => {
                        if (!blob) {
                            reject(new Error('PDF oluşturulamadı'));
                            return;
                        }
                        
                        // Not: Gerçek PDF değil, resim olarak kaydediyoruz
                        // Gerçek PDF için jsPDF gibi kütüphane gerekir
                        const url = URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = file.name.replace(/\.[^.]+$/, '.jpg');
                        document.body.appendChild(a);
                        a.click();
                        
                        setTimeout(() => {
                            document.body.removeChild(a);
                            URL.revokeObjectURL(url);
                        }, 100);
                        
                        resolve();
                    }, 'image/jpeg', 0.95);
                } catch (err) {
                    reject(err);
                }
            };
            img.onerror = () => reject(new Error('Resim yüklenemedi'));
            img.src = e.target.result;
        };
        reader.onerror = () => reject(new Error('Dosya okunamadı'));
        reader.readAsDataURL(file);
    });
}

async function convertMiniImage(file, target) {
    console.log('🎨 convertMiniImage çağrıldı:', file.name, '→', target);
    return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = e => {
            console.log('📖 Dosya okundu');
            const img = new Image();
            img.onload = () => {
                console.log('🖼️ Resim yüklendi:', img.width, 'x', img.height);
                try {
                    const canvas = document.createElement('canvas');
                    canvas.width = img.width;
                    canvas.height = img.height;
                    const ctx = canvas.getContext('2d');
                    
                    if (target === 'jpeg' || target === 'jpg') {
                        ctx.fillStyle = 'white';
                        ctx.fillRect(0, 0, canvas.width, canvas.height);
                    }
                    
                    ctx.drawImage(img, 0, 0);
                    console.log('✏️ Canvas çizildi');
                    
                    const mime = target === 'png' ? 'image/png' : 
                                target === 'webp' ? 'image/webp' : 
                                target === 'bmp' ? 'image/bmp' :
                                target === 'gif' ? 'image/gif' : 'image/jpeg';
                    
                    console.log('📦 Blob oluşturuluyor, MIME:', mime);
                    canvas.toBlob(blob => {
                        if (!blob) {
                            console.error('❌ Blob oluşturulamadı!');
                            reject(new Error('Blob oluşturulamadı'));
                            return;
                        }
                        
                        console.log('✅ Blob oluşturuldu:', blob.size, 'bytes');
                        const url = URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = file.name.replace(/\.[^.]+$/, '.' + target);
                        document.body.appendChild(a);
                        console.log('💾 İndirme tetikleniyor:', a.download);
                        a.click();
                        console.log('✅ Click tetiklendi!');
                        
                        // Cleanup
                        setTimeout(() => {
                            document.body.removeChild(a);
                            URL.revokeObjectURL(url);
                            console.log('🧹 Temizlik yapıldı');
                        }, 100);
                        
                        resolve();
                    }, mime, 0.95);
                } catch (err) {
                    console.error('❌ Canvas hatası:', err);
                    reject(err);
                }
            };
            img.onerror = () => {
                console.error('❌ Resim yüklenemedi');
                reject(new Error('Resim yüklenemedi'));
            };
            img.src = e.target.result;
        };
        reader.onerror = () => {
            console.error('❌ Dosya okunamadı');
            reject(new Error('Dosya okunamadı'));
        };
        reader.readAsDataURL(file);
    });
}

function getMiniToolInfo(from, to) {
    const tools = {
        // DWG Dönüşümleri
        'dwg-pdf': '🔧 <a href="https://www.opendesign.com/guestfiles/oda_file_converter" target="_blank" style="color:#667eea;font-weight:600">ODA File Converter</a> (Ücretsiz)',
        'dwg-jpeg': '🔧 <a href="https://www.zamzar.com/convert/dwg-to-jpg" target="_blank" style="color:#667eea;font-weight:600">Zamzar</a> veya AutoCAD',
        'dwg-png': '🔧 <a href="https://cloudconvert.com/dwg-to-png" target="_blank" style="color:#667eea;font-weight:600">CloudConvert</a>',
        'dwg-svg': '🔧 <a href="https://cloudconvert.com/dwg-to-svg" target="_blank" style="color:#667eea;font-weight:600">CloudConvert</a>',
        'dwg-dxf': '🔧 <a href="https://www.opendesign.com/guestfiles/oda_file_converter" target="_blank" style="color:#667eea;font-weight:600">ODA Converter</a> - Hızlı',
        'dwg-dwf': '🔧 AutoCAD veya <a href="https://www.autodesk.com/products/dwg" target="_blank" style="color:#667eea;font-weight:600">Autodesk Viewer</a>',
        'dwg-sürüm': '⚙️ <a href="https://www.opendesign.com/guestfiles/oda_file_converter" target="_blank" style="color:#667eea;font-weight:600">ODA File Converter</a> - 2010/2007/2004',
        'dwg-3d': '🔧 <a href="https://www.opendesign.com/guestfiles/oda_file_converter" target="_blank" style="color:#667eea;font-weight:600">ODA Converter</a> + 3D PDF',
        
        // DXF Dönüşümleri
        'dxf-dwg': '🔧 <a href="https://www.opendesign.com/guestfiles/oda_file_converter" target="_blank" style="color:#667eea;font-weight:600">ODA File Converter</a>',
        'dxf-pdf': '🔧 <a href="https://cloudconvert.com/dxf-to-pdf" target="_blank" style="color:#667eea;font-weight:600">CloudConvert</a>',
        
        // PDF Dönüşümleri
        'pdf-word': '📝 <a href="https://www.ilovepdf.com/tr/pdf_to_word" target="_blank" style="color:#667eea;font-weight:600">ILovePDF</a>',
        'pdf-excel': '📊 <a href="https://www.ilovepdf.com/tr/pdf_to_excel" target="_blank" style="color:#667eea;font-weight:600">ILovePDF</a>',
        'pdf-ppt': '🎯 <a href="https://www.ilovepdf.com/tr" target="_blank" style="color:#667eea;font-weight:600">ILovePDF</a>',
        'pdf-dwg': '📐 <a href="https://cloudconvert.com/pdf-to-dwg" target="_blank" style="color:#667eea;font-weight:600">CloudConvert</a> veya <a href="https://www.zamzar.com" target="_blank" style="color:#667eea;font-weight:600">Zamzar</a>',
        'pdf-ayır': '✂️ <a href="https://www.ilovepdf.com/tr/split_pdf" target="_blank" style="color:#667eea;font-weight:600">ILovePDF Split</a>',
        'pdf-birleştir': '🔗 <a href="https://www.ilovepdf.com/tr/merge_pdf" target="_blank" style="color:#667eea;font-weight:600">ILovePDF Merge</a>',
        
        // Office Dönüşümleri
        'docx-pdf': '📄 MS Word → Dosya → Farklı Kaydet → PDF',
        'xlsx-pdf': '📊 MS Excel → Dosya → Farklı Kaydet → PDF',
        'pptx-pdf': '🎯 MS PowerPoint → Dosya → Farklı Kaydet → PDF',
        'doc-docx': '📝 MS Word → Dosya → Farklı Kaydet → .docx',
        'xls-xlsx': '📊 MS Excel → Dosya → Farklı Kaydet → .xlsx',
        
        // Video Dönüşümleri
        'mp4-mp3': '🎵 <a href="https://cloudconvert.com/mp4-to-mp3" target="_blank" style="color:#667eea;font-weight:600">CloudConvert</a>',
        'mp4-gif': '🎬 <a href="https://ezgif.com/video-to-gif" target="_blank" style="color:#667eea;font-weight:600">EZGIF</a>',
        'avi-mp4': '📹 <a href="https://cloudconvert.com/avi-to-mp4" target="_blank" style="color:#667eea;font-weight:600">CloudConvert</a>',
        'mov-mp4': '📹 <a href="https://cloudconvert.com/mov-to-mp4" target="_blank" style="color:#667eea;font-weight:600">CloudConvert</a>',
        
        // Arşiv Dönüşümleri
        'zip-rar': '📦 WinRAR veya <a href="https://www.online-convert.com" target="_blank" style="color:#667eea;font-weight:600">Online-Convert</a>',
        'rar-zip': '📦 WinRAR veya <a href="https://www.online-convert.com" target="_blank" style="color:#667eea;font-weight:600">Online-Convert</a>',
        
        // Tasarım Dönüşümleri
        'psd-png': '🎨 Photoshop veya <a href="https://www.photopea.com" target="_blank" style="color:#667eea;font-weight:600">Photopea</a> (Ücretsiz)',
        'ai-svg': '🎨 Illustrator veya <a href="https://cloudconvert.com" target="_blank" style="color:#667eea;font-weight:600">CloudConvert</a>'
    };
    
    return tools[`${from}-${to}`] || `🔧 <a href="https://cloudconvert.com" target="_blank" style="color:#667eea;font-weight:600">CloudConvert</a> veya <a href="https://www.zamzar.com" target="_blank" style="color:#667eea;font-weight:600">Zamzar</a>`;
}

function resetMiniConverter() {
    miniFile = null;
    document.getElementById('miniConverterFile').value = '';
    document.getElementById('miniConverterFormat').style.display = 'none';
    document.getElementById('miniConvertBtn').style.display = 'none';
    document.getElementById('miniConverterStatus').textContent = '';
}

// ========================================
// ESKI SİSTEM FONKSİYONLARI
// ========================================

// Session manager başlat ve eski session kontrolü
document.addEventListener('DOMContentLoaded', function() {
    // Session manager başlat
    SessionManager.init();
    
    // Eski session kontrolü
    const oldSession = sessionStorage.getItem('admin_session');
    if (oldSession && !SessionManager.isExpired()) {
        // Geçerli session var, direkt paneli aç
        isAuthenticated = true;
        const loginScreenEl = document.getElementById('loginScreen');
        const adminPanelEl = document.getElementById('adminPanel');
        if (loginScreenEl) loginScreenEl.classList.add('hidden');
        if (adminPanelEl) adminPanelEl.classList.remove('hidden');
        init();
        console.log('%c♻️ Mevcut oturum yüklendi', 'color: #2196F3; font-weight: bold');
    }
});

// Console uyarısı
console.log('%c⚠️ GÜVENLİK UYARISI', 'color: red; font-size: 20px; font-weight: bold');
console.log('%cBu konsol sadece geliştiriciler içindir!', 'color: orange; font-size: 14px');
console.log('%cBuraya kod yapıştırmayın!', 'color: orange; font-size: 14px');

// CHAT WIDGET FUNCTIONS
let chatOpen = false;
let chatMessages = [];

function toggleChat() {
    chatOpen = !chatOpen;
    const chatWindow = document.getElementById('chatWindow');
    const chatBadge = document.getElementById('chatBadge');
    
    if (chatOpen) {
        chatWindow.classList.remove('hidden');
        if (chatBadge) {
            chatBadge.textContent = '0';
            chatBadge.style.display = 'none';
        }
    } else {
        chatWindow.classList.add('hidden');
    }
}

function sendChatMessage() {
    const input = document.getElementById('chatInput');
    const message = input.value.trim();
    
    if (!message) return;
    
    addChatMessage(message, 'user');
    input.value = '';
    
    setTimeout(() => {
        const responses = [
            'Mesajınızı aldım, en kısa sürede dönüş yapacağım.',
            'Teşekkür ederim, bilgilerinizi inceleyeceğim.',
            'Sorularınızı not aldım, size yardımcı olmak için buradayım.'
        ];
        const randomResponse = responses[Math.floor(Math.random() * responses.length)];
        addChatMessage(randomResponse, 'bot');
    }, 1000);
}

function addChatMessage(text, type) {
    const messagesContainer = document.getElementById('chatMessages');
    const messageDiv = document.createElement('div');
    messageDiv.className = `chat-message ${type}`;
    
    const now = new Date();
    const time = now.getHours().toString().padStart(2, '0') + ':' + 
                 now.getMinutes().toString().padStart(2, '0');
    
    messageDiv.innerHTML = `
        <div class="message-content">${text}</div>
        <div class="message-time">${time}</div>
    `;
    
    messagesContainer.appendChild(messageDiv);
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
    
    chatMessages.push({
        text: text,
        type: type,
        time: now.toISOString()
    });
    
    try {
        localStorage.setItem('admin_chat_messages', JSON.stringify(chatMessages));
    } catch (e) {}
}



// ==============================================
// SİTE AYARLARI FONKSİYONLARI
// ==============================================

// Site Ayarları Modalını Aç
function openSiteSettings() {
    document.getElementById('siteSettingsModal').style.display = 'block';
    loadSiteSettings();
}

// Site Ayarları Modalını Kapat
function closeSiteSettings() {
    document.getElementById('siteSettingsModal').style.display = 'none';
}

// Tab Değiştir
function switchSettingsTab(tabName) {
    // Tüm tab içeriklerini gizle
    document.querySelectorAll('.settings-tab-content').forEach(tab => {
        tab.style.display = 'none';
    });
    
    // Tüm tab butonlarını pasif yap
    document.querySelectorAll('.settings-tab-btn').forEach(btn => {
        btn.style.color = '#666';
        btn.style.borderBottomColor = 'transparent';
    });
    
    // Seçili tabı göster
    document.getElementById(tabName + 'Tab').style.display = 'block';
    document.getElementById(tabName + 'TabBtn').style.color = '#667eea';
    document.getElementById(tabName + 'TabBtn').style.borderBottomColor = '#667eea';
}

// Ayarları Yükle
function loadSiteSettings() {
    // Logo yükle
    const siteLogo = localStorage.getItem('site_logo');
    if (siteLogo) {
        document.getElementById('logoPreviewContent').innerHTML = `<img src="${siteLogo}" style="max-width: 100%; max-height: 120px; object-fit: contain;">`;
    }
    
    // Hero ayarlarını yükle
    const heroSettings = JSON.parse(localStorage.getItem('hero_settings') || '{}');
    if (heroSettings.title) document.getElementById('heroTitle').value = heroSettings.title;
    if (heroSettings.subtitle) document.getElementById('heroSubtitle').value = heroSettings.subtitle;
    if (heroSettings.fontSize) {
        document.getElementById('heroFontSize').value = parseInt(heroSettings.fontSize);
        document.getElementById('fontSizeValue').textContent = heroSettings.fontSize;
    }
    if (heroSettings.fontWeight) document.getElementById('heroFontWeight').value = heroSettings.fontWeight;
    if (heroSettings.color) document.getElementById('heroColor').value = heroSettings.color;
    
    // Sosyal medya linklerini yükle
    const socialLinks = JSON.parse(localStorage.getItem('social_links') || '{}');
    if (socialLinks.instagram) document.getElementById('instagramLink').value = socialLinks.instagram;
    if (socialLinks.facebook) document.getElementById('facebookLink').value = socialLinks.facebook;
    if (socialLinks.linkedin) document.getElementById('linkedinLink').value = socialLinks.linkedin;
    if (socialLinks.twitter) document.getElementById('twitterLink').value = socialLinks.twitter;
    if (socialLinks.youtube) document.getElementById('youtubeLink').value = socialLinks.youtube;
    
    // Ekip ayarlarını yükle
    const teamSettings = JSON.parse(localStorage.getItem('team_settings') || '{}');
    if (teamSettings.title) document.getElementById('teamSectionTitle').value = teamSettings.title;
    if (teamSettings.description) document.getElementById('teamSectionDesc').value = teamSettings.description;
    loadTeamMembers();
    
    // Renk ayarlarını yükle
    const colorSettings = JSON.parse(localStorage.getItem('color_settings') || '{}');
    if (colorSettings.primary) document.getElementById('primaryColor').value = colorSettings.primary;
    if (colorSettings.secondary) document.getElementById('secondaryColor').value = colorSettings.secondary;
    if (colorSettings.accent) document.getElementById('accentColor').value = colorSettings.accent;
}

// Hero Ayarlarını Kaydet
function saveHeroSettings() {
    const settings = {
        title: document.getElementById('heroTitle').value,
        subtitle: document.getElementById('heroSubtitle').value,
        fontSize: document.getElementById('heroFontSize').value + 'px',
        fontWeight: document.getElementById('heroFontWeight').value,
        color: document.getElementById('heroColor').value
    };
    
    localStorage.setItem('hero_settings', JSON.stringify(settings));
    showToast('✅ Hero ayarları kaydedildi!', 'success');
}

// Sosyal Medya Linklerini Kaydet
function saveSocialLinks() {
    const links = {
        instagram: document.getElementById('instagramLink').value,
        facebook: document.getElementById('facebookLink').value,
        linkedin: document.getElementById('linkedinLink').value,
        twitter: document.getElementById('twitterLink').value,
        youtube: document.getElementById('youtubeLink').value
    };
    
    localStorage.setItem('social_links', JSON.stringify(links));
    showToast('✅ Sosyal medya linkleri kaydedildi!', 'success');
}

// Ekip Üyesi Ekle
function addTeamMember() {
    const name = document.getElementById('teamMemberName').value;
    const title = document.getElementById('teamMemberTitle').value;
    const desc = document.getElementById('teamMemberDesc').value;
    const photoInput = document.getElementById('teamMemberPhoto');
    
    if (!name || !title) {
        showToast('❌ Ad ve ünvan zorunludur!', 'error');
        return;
    }
    
    const members = JSON.parse(localStorage.getItem('team_members') || '[]');
    const member = {
        id: Date.now(),
        name: name,
        title: title,
        description: desc,
        photo: ''
    };
    
    if (photoInput.files.length > 0) {
        const reader = new FileReader();
        reader.onload = function(e) {
            member.photo = e.target.result;
            members.push(member);
            localStorage.setItem('team_members', JSON.stringify(members));
            loadTeamMembers();
            clearTeamMemberForm();
            showToast('✅ Ekip üyesi eklendi!', 'success');
        };
        reader.readAsDataURL(photoInput.files[0]);
    } else {
        members.push(member);
        localStorage.setItem('team_members', JSON.stringify(members));
        loadTeamMembers();
        clearTeamMemberForm();
        showToast('✅ Ekip üyesi eklendi!', 'success');
    }
}

// Ekip Üyelerini Listele
function loadTeamMembers() {
    const members = JSON.parse(localStorage.getItem('team_members') || '[]');
    const list = document.getElementById('teamMembersList');
    
    if (members.length === 0) {
        list.innerHTML = '<p style="text-align: center; color: #999; padding: 20px;">Henüz ekip üyesi eklenmedi</p>';
        return;
    }
    
    list.innerHTML = members.map(member => `
        <div style="background: white; border: 2px solid #e5e7eb; border-radius: 8px; padding: 15px; margin-bottom: 15px; display: flex; gap: 15px; align-items: center;">
            ${member.photo ? `<img src="${member.photo}" style="width: 60px; height: 60px; border-radius: 50%; object-fit: cover;">` : '<div style="width: 60px; height: 60px; border-radius: 50%; background: #e5e7eb; display: flex; align-items: center; justify-content: center; font-size: 24px;">👤</div>'}
            <div style="flex: 1;">
                <strong style="display: block; color: #333; margin-bottom: 4px;">${member.name}</strong>
                <div style="color: #667eea; font-size: 14px; margin-bottom: 4px;">${member.title}</div>
                ${member.description ? `<div style="color: #666; font-size: 13px;">${member.description}</div>` : ''}
            </div>
            <button onclick="deleteTeamMember(${member.id})" style="background: #ef4444; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer;">
                🗑️ Sil
            </button>
        </div>
    `).join('');
}

// Ekip Üyesi Sil
function deleteTeamMember(id) {
    if (!confirm('Bu ekip üyesini silmek istediğinizden emin misiniz?')) return;
    
    let members = JSON.parse(localStorage.getItem('team_members') || '[]');
    members = members.filter(m => m.id !== id);
    localStorage.setItem('team_members', JSON.stringify(members));
    loadTeamMembers();
    showToast('✅ Ekip üyesi silindi!', 'success');
}

// Ekip Formu Temizle
function clearTeamMemberForm() {
    document.getElementById('teamMemberName').value = '';
    document.getElementById('teamMemberTitle').value = '';
    document.getElementById('teamMemberDesc').value = '';
    document.getElementById('teamMemberPhoto').value = '';
}

// Logo Upload
function handleLogoUpload(input) {
    if (input.files && input.files[0]) {
        const reader = new FileReader();
        reader.onload = function(e) {
            const logoData = e.target.result;
            localStorage.setItem('site_logo', logoData);
            document.getElementById('logoPreviewContent').innerHTML = `<img src="${logoData}" style="max-width: 100%; max-height: 120px; object-fit: contain;">`;
            showToast('✅ Logo başarıyla yüklendi!', 'success');
        };
        reader.readAsDataURL(input.files[0]);
    }
}

// Logo Kaldır
function removeLogo() {
    if (!confirm('Logoyu kaldırmak istediğinizden emin misiniz?')) return;
    
    localStorage.removeItem('site_logo');
    document.getElementById('logoPreviewContent').innerHTML = 'Logo yüklenmedi';
    document.getElementById('logoUpload').value = '';
    showToast('✅ Logo kaldırıldı!', 'success');
}

// Ekip Ayarlarını Kaydet
function saveTeamSettings() {
    const settings = {
        title: document.getElementById('teamSectionTitle').value,
        description: document.getElementById('teamSectionDesc').value
    };
    
    localStorage.setItem('team_settings', JSON.stringify(settings));
    showToast('✅ Ekip bölümü ayarları kaydedildi!', 'success');
}

// Renk Ayarlarını Kaydet
function saveColorSettings() {
    const settings = {
        primary: document.getElementById('primaryColor').value,
        secondary: document.getElementById('secondaryColor').value,
        accent: document.getElementById('accentColor').value
    };
    
    localStorage.setItem('color_settings', JSON.stringify(settings));
    showToast('✅ Renk ayarları kaydedildi! Sayfayı yenileyerek değişiklikleri görebilirsiniz.', 'success');
}

// Renkleri Sıfırla
function resetColors() {
    if (!confirm('Renkleri varsayılana döndürmek istediğinizden emin misiniz?')) return;
    
    document.getElementById('primaryColor').value = '#667eea';
    document.getElementById('secondaryColor').value = '#764ba2';
    document.getElementById('accentColor').value = '#10b981';
    
    localStorage.removeItem('color_settings');
    showToast('✅ Renkler varsayılana döndürüldü!', 'success');
}

// Toast Bildirimi
function showToast(message, type = 'success') {
    const toast = document.createElement('div');
    toast.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 15px 25px;
        background: ${type === 'success' ? '#10b981' : '#ef4444'};
        color: white;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        z-index: 100000;
        animation: slideIn 0.3s ease;
    `;
    toast.textContent = message;
    document.body.appendChild(toast);
    
    setTimeout(() => {
        toast.style.animation = 'slideOut 0.3s ease';
        setTimeout(() => toast.remove(), 300);
    }, 3000);
}

</script>

<!-- CHAT WIDGET -->
<div id="chatWidget" class="chat-widget">
    <button class="chat-toggle" onclick="toggleChat()">
        💬
        <span class="chat-badge" id="chatBadge" style="display:none;">0</span>
    </button>
    
    <div class="chat-window hidden" id="chatWindow">
        <div class="chat-header">
            <h3>💬 Canlı Destek</h3>
            <button onclick="toggleChat()" style="background: none; border: none; color: white; font-size: 20px; cursor: pointer;">×</button>
        </div>
        
        <div class="chat-messages" id="chatMessages">
            <div class="chat-message bot">
                <div class="message-content">
                    Merhaba! Size nasıl yardımcı olabilirim?
                </div>
                <div class="message-time">Şimdi</div>
            </div>
        </div>
        
        <div class="chat-input-area">
            <input type="text" id="chatInput" placeholder="Mesajınızı yazın..." onkeypress="if(event.key==='Enter') sendChatMessage()">
            <button onclick="sendChatMessage()">📤</button>
        </div>
    </div>
</div>

<script>
// OTOMATIK GİRİŞ - Dosyaları doğrudan açıldığında localStorage sorunu için
window.addEventListener('load', function() {
    // Eğer file:// protokolü ile açıldıysa otomatik giriş yap
    if (window.location.protocol === 'file:') {
        console.log('File protokolü tespit edildi - Otomatik giriş yapılıyor...');
        setTimeout(function() {
            const loginScreen = document.getElementById('loginScreen');
            const adminPanel = document.getElementById('adminPanel');
            if (loginScreen && adminPanel) {
                loginScreen.style.display = 'none';
                adminPanel.style.display = 'block';
                loadData();
                loadStats();
                loadTeamMembers();
                loadSiteSettings();
                showToast('✅ Otomatik giriş yapıldı! (File protokolü)', 'success');
            }
        }, 500);
    }
});
</script>

</body>
</html>
